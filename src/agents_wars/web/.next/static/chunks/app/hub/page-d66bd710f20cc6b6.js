(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[325],{6985:function(e,t,a){Promise.resolve().then(a.bind(a,2761))},2761:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return f}});var s=a(7437),n=a(2265),r=a(5694),l=a(9733),i=a(4839);let d=n.forwardRef((e,t)=>{let{className:a,children:n,...r}=e;return(0,s.jsx)("select",{ref:t,className:(0,i.Z)("rounded bg-slate-800 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-primary border border-slate-700",a),...r,children:n})});function o(e){let{className:t,...a}=e;return(0,s.jsx)("label",{className:(0,i.Z)("text-sm text-slate-300",t),...a})}d.displayName="Select";var c=a(7209),u=a(4919);let m=n.createContext(null);function g(e){let{value:t,defaultValue:a,onValueChange:r,className:l,children:i}=e,[d,o]=n.useState(a||""),c=void 0!==t,u=c?t:d,g=n.useCallback(e=>{c||o(e),null==r||r(e)},[c,r]);return(0,s.jsx)(m.Provider,{value:{value:u,setValue:g},children:(0,s.jsx)("div",{className:l,children:i})})}function p(e){let{className:t,...a}=e;return(0,s.jsx)("div",{role:"tablist",className:(0,i.Z)("inline-flex items-center gap-2",t),...a})}function x(e){let{value:t,className:a,children:r}=e,l=n.useContext(m),d=(null==l?void 0:l.value)===t,o=n.useMemo(()=>"tab-".concat(t),[t]),c=n.useMemo(()=>"tabpanel-".concat(t),[t]);return(0,s.jsx)("button",{type:"button",role:"tab",id:o,"aria-selected":d,"aria-controls":c,tabIndex:d?0:-1,className:(0,i.Z)("rounded px-3 py-1 text-sm",d?"bg-blue-600 text-white":"bg-slate-700 text-slate-100",a),onClick:()=>null==l?void 0:l.setValue(t),children:r})}function h(e){let{className:t,checked:a,onChange:n,...r}=e;return(0,s.jsxs)("label",{className:(0,i.Z)("relative inline-flex cursor-pointer items-center",t),children:[(0,s.jsx)("input",{type:"checkbox",className:"peer sr-only",checked:!!a,onChange:n,...r}),(0,s.jsx)("div",{className:"h-5 w-9 rounded-full bg-slate-700 transition peer-checked:bg-blue-600"}),(0,s.jsx)("div",{className:"absolute left-0.5 top-0.5 h-4 w-4 rounded-full bg-white transition peer-checked:translate-x-4"})]})}function f(){let[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),[m,f]=(0,n.useState)(null),[v,y]=(0,n.useState)([]),[j,N]=(0,n.useState)(""),[w,S]=(0,n.useState)("openai"),[k,C]=(0,n.useState)(""),[A,M]=(0,n.useState)(""),[D,E]=(0,n.useState)(""),[F,B]=(0,n.useState)(""),[P,R]=(0,n.useState)(!1),[T,I]=(0,n.useState)({}),[O,_]=(0,n.useState)([]),J=(0,n.useRef)(!0),Z=(0,n.useRef)({}),z=(0,n.useRef)(!1);(0,n.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("hub.form")||"{}");e.agentId&&N(e.agentId),e.provider&&S(e.provider),e.model&&C(e.model),e.goal&&M(e.goal),e.systemPrompt&&E(e.systemPrompt),e.userMessage&&B(e.userMessage);let t=JSON.parse(localStorage.getItem("hub.sessions")||"[]");Array.isArray(t)&&t.length&&_(t)}catch(e){}},[]),(0,n.useEffect)(()=>{try{localStorage.setItem("hub.form",JSON.stringify({agentId:j,provider:w,model:k,goal:A,systemPrompt:D,userMessage:F}))}catch(e){}},[j,w,k,A,D,F]),(0,n.useEffect)(()=>{try{localStorage.setItem("hub.sessions",JSON.stringify(O))}catch(e){}},[O]),(0,n.useEffect)(()=>()=>{z.current=!0},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/agents",{cache:"no-store"});if(!e.ok)throw Error("agents_failed");let a=await e.json();t(a.items)}catch(e){t([]),f((null==e?void 0:e.message)||"Failed to load agents")}finally{i(!1)}})()},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/config/provider-status",{cache:"no-store"});if(!e.ok)return;let t=await e.json();y(Array.isArray(t.allowedModels)?t.allowedModels:[])}catch(e){y([])}})()},[D]);let H=(0,n.useCallback)(()=>{let e={};return j.trim()||(e.agentId="Agent ID is required"),k.trim()||(e.model="Model is required"),k.trim()&&v.length>0&&!v.includes(k.trim())&&(e.model="Model not allowed"),I(e),0===Object.keys(e).length},[j,k,v]),L=(0,n.useCallback)(e=>{let t=!1,a=0,s=0;function n(e){let t=0;for(let a=0;a<e.length;a++)t=(t+e.charCodeAt(a))%9973;return t%400}async function r(l){if(t||z.current)return;try{let t=await fetch("/api/battles/".concat(e,"/status?format=json"),{cache:"no-store"});if(429===t.status||t.status>=500){let t=Math.min((null!=l?l:1200)*2,5e3);setTimeout(()=>r(t),t+n(e));return}if(!t.ok)throw Error("status_failed");let d=await t.json();"number"==typeof d.updatedAt&&(d.updatedAt===s?a+=1:(a=0,s=d.updatedAt)),_(t=>t.map(t=>t.id!==e||t.endedReason?t:{...t,status:d.status,error:d.error}));let o=d.data,c=null==o?void 0:o.conversationId;if(c){let t=await fetch("/api/battles/".concat(c,"/messages?page=1&limit=100"),{cache:"no-store"});if(t.ok){let a=await t.json();_(t=>t.map(t=>t.id!==e||t.endedReason?t:{...t,conversationId:c,messages:a.items}))}}if("succeeded"===d.status||"failed"===d.status){var i;let t=null===(i=d.data)||void 0===i?void 0:i.endedReason;_(a=>a.map(a=>a.id===e?{...a,endedReason:t}:a));return}}catch(e){}let d=a>=3?3500:1200;setTimeout(()=>r(),(null!=l?l:d)+n(e))}return setTimeout(()=>r(),n(e)),()=>{t=!0}},[]),U=(0,n.useCallback)(async()=>{if(H()){R(!0);try{let t=await fetch("/api/battles/start",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({agentId:j,provider:w,model:k,goal:A,systemPrompt:D,userMessage:F})}),a=await t.json();if(!t.ok||"error"in a){let t=(null==a?void 0:a.error)==="invalid_agent"?"Selected agent is invalid or not found":"Failed to start",s="err-".concat(Date.now());_(a=>[...a,{id:s,provider:w,model:k,status:"failed",error:t,goal:A,userMessage:F,messages:[],agent:e.find(e=>e.id===j)}]);return}let s=a.id,n={id:s,provider:w,model:k,goal:A,userMessage:F,status:"pending",agent:e.find(e=>e.id===j),messages:[],polling:!0};_(e=>e.some(e=>e.id===s)?e.map(e=>e.id===s?{...e,...n}:e):[...e,n]),L(s)}catch(a){let t="err-".concat(Date.now());_(s=>[...s,{id:t,provider:w,model:k,status:"failed",error:(null==a?void 0:a.message)||String(a),goal:A,userMessage:F,messages:[],agent:e.find(e=>e.id===j)}])}finally{R(!1)}}},[e,j,w,k,A,F,H,L,D]);(0,n.useEffect)(()=>{function e(e){let t=navigator.platform.toLowerCase().includes("mac")?e.metaKey:e.ctrlKey;if(t&&"Enter"===e.key&&j.trim()&&k.trim()&&!P&&(e.preventDefault(),U()),!t&&("s"===e.key||"S"===e.key)){let t=[...O].reverse().find(e=>"succeeded"!==e.status&&"failed"!==e.status);t&&(e.preventDefault(),fetch("/api/battles/".concat(t.id,"/cancel"),{method:"POST"}).catch(()=>{_(e=>e.map(e=>e.id===t.id?{...e,status:"failed",endedReason:"manual"}:e))}))}}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[j,k,P,U,O]),(0,n.useEffect)(()=>{J.current&&O.forEach(e=>{let t=Z.current[e.id];t&&(t.scrollTop=t.scrollHeight)})},[O]);let[q,K]=(0,n.useState)("hub"),V=function(e){let{agentId:t,provider:a,model:s,allowedModels:r}=e,[l,i]=(0,n.useState)(""),[d,o]=(0,n.useState)(""),[c,u]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),b=(0,n.useMemo)(()=>{let e=s.trim();return!!e&&(!r||0===r.length||r.includes(e))},[s,r]),v=(0,n.useMemo)(()=>!!(t.trim()&&b&&l.trim()),[t,b,l]),y=(0,n.useCallback)(async()=>{if(v&&!h){f(!0);try{x(!0),g(!1)}finally{f(!1)}}},[v,h]);return{broadcast:l,setBroadcast:i,promptA:d,setPromptA:o,promptB:c,setPromptB:u,reveal:m,setReveal:g,isRunning:p,isStarting:h,canStart:v,startArena:y}}({agentId:j,provider:w,model:k,allowedModels:v}),[W,G]=(0,n.useState)(!1),[$,Q]=(0,n.useState)(!1),[X,Y]=(0,n.useState)(null),[ee,et]=(0,n.useState)(null),[ea,es]=(0,n.useState)(null),en=(0,n.useCallback)(async()=>{if(!W&&j.trim()&&k.trim()&&(!(v.length>0)||v.includes(k.trim()))&&V.broadcast.trim()){G(!0);try{let t={"content-type":"application/json"},a={agentId:j,provider:w,model:k,userMessage:V.broadcast},s=await fetch("/api/battles/start",{method:"POST",headers:t,body:JSON.stringify({...a,systemPrompt:V.promptA||void 0})}),n=await s.json(),r=!1;if(!s.ok||n.error){let t="arena-A-".concat(Date.now());_(a=>[...a,{id:t,provider:w,model:k,status:"failed",error:"Failed to start (A)",messages:[],agent:e.find(e=>e.id===j)}])}else{let t=n.id,a={id:t,provider:w,model:k,status:"pending",agent:e.find(e=>e.id===j),messages:[],polling:!0};_(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?{...e,...a}:e):[...e,a]),Y(t),L(t),r=!0}let l=await fetch("/api/battles/start",{method:"POST",headers:t,body:JSON.stringify({...a,systemPrompt:V.promptB||void 0})}),i=await l.json(),d=!1;if(!l.ok||i.error){let t="arena-B-".concat(Date.now());_(a=>[...a,{id:t,provider:w,model:k,status:"failed",error:"Failed to start (B)",messages:[],agent:e.find(e=>e.id===j)}])}else{let t=i.id,a={id:t,provider:w,model:k,status:"pending",agent:e.find(e=>e.id===j),messages:[],polling:!0};_(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?{...e,...a}:e):[...e,a]),et(t),L(t),d=!0}Q(r&&d)}catch(e){}finally{G(!1)}}},[W,j,w,k,v,V.broadcast,V.promptA,V.promptB,e,L]),er=(0,n.useMemo)(()=>{if(!X||!ee)return null;let e=O.find(e=>e.id===X),t=O.find(e=>e.id===ee);if(!e||!t)return null;function a(e){let t=e.map(e=>e.content).join(" ");return t?Math.ceil(t.length/4):0}function s(e){let t=[];for(let a=1;a<e.length;a++){let s=Date.parse(e[a-1].createdAt),n=Date.parse(e[a].createdAt);Number.isNaN(s)||Number.isNaN(n)||!(n>=s)||t.push(n-s)}if(!t.length)return 0;t.sort((e,t)=>e-t);let a=Math.floor(t.length/2);return t.length%2?t[a]:Math.floor((t[a-1]+t[a])/2)}function n(e){let t=[];for(let a=1;a<e.length;a++){let s=Date.parse(e[a-1].createdAt),n=Date.parse(e[a].createdAt);Number.isNaN(s)||Number.isNaN(n)||!(n>=s)||t.push(n-s)}return t.length?Math.ceil(t.reduce((e,t)=>e+t,0)/t.length):0}function r(e){return e.length}let l={terminal:"succeeded"===e.status||"failed"===e.status,succeeded:"succeeded"===e.status||"goal"===e.endedReason,turns:r(e.messages),tokens:a(e.messages),latency:s(e.messages),tokensPerTurn:(()=>{let t=r(e.messages);return t>0?Math.ceil(a(e.messages)/t):0})(),latencyPerTurn:n(e.messages)},i={terminal:"succeeded"===t.status||"failed"===t.status,succeeded:"succeeded"===t.status||"goal"===t.endedReason,turns:r(t.messages),tokens:a(t.messages),latency:s(t.messages),tokensPerTurn:(()=>{let e=r(t.messages);return e>0?Math.ceil(a(t.messages)/e):0})(),latencyPerTurn:n(t.messages)},d="tie";return d=l.succeeded&&!i.succeeded?"A":!l.succeeded&&i.succeeded?"B":l.succeeded&&i.succeeded?l.turns!==i.turns?l.turns<i.turns?"A":"B":l.tokens!==i.tokens?l.tokens<i.tokens?"A":"B":l.latency!==i.latency?l.latency<i.latency?"A":"B":"tie":"tie",{a:l,b:i,winner:d}},[X,ee,O]);return(0,n.useEffect)(()=>{if(!er)return;let{a:e,b:t,winner:a}=er,s="";if("tie"===a)s="Tie: either both failed or all metrics equal.";else if("A"===a||"B"===a){let n="A"===a?e:t,r="A"===a?t:e;s=n.succeeded&&!r.succeeded?"".concat(a," succeeded while the other did not."):n.turns!==r.turns?"".concat(a," used fewer turns (").concat(n.turns," < ").concat(r.turns,")."):n.tokens!==r.tokens?"".concat(a," used fewer tokens (").concat(n.tokens," < ").concat(r.tokens,")."):n.latency!==r.latency?"".concat(a," had lower median latency (").concat(n.latency,"ms < ").concat(r.latency,"ms)."):"".concat(a," is marginally ahead on tie-breakers.")}es({winner:a,reasoning:s})},[er]),(0,s.jsxs)("main",{className:"mx-auto grid max-w-5xl gap-4 p-6",style:{backgroundColor:"#ECEADF"},children:[(0,s.jsx)("h1",{className:"text-2xl font-semibold",style:{color:"#3F404C"},children:"Agent Wars Hub"}),(0,s.jsx)(g,{value:q,onValueChange:e=>K(e),children:(0,s.jsxs)(p,{children:[(0,s.jsx)(x,{value:"hub",children:"Hub"}),(0,s.jsx)(x,{value:"arena",children:"Arena (A/B)"})]})}),"hub"===q?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{className:"grid gap-3 rounded-[12px]",style:{background:"#fff",border:"1px solid #DFD4CA",padding:"24px",boxShadow:"0 1px 3px rgba(63,64,76,0.1), 0 1px 2px rgba(63,64,76,0.06)"},children:[m?(0,s.jsx)("div",{className:"text-sm text-yellow-300",children:"Failed to load agents"}):null,(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(o,{className:"text-sm",style:{color:"#3F404C"},children:"Agent"}),(0,s.jsxs)(d,{value:j,onChange:e=>N(e.target.value),"data-testid":"agent-id",className:"border",style:{borderColor:"#DFD4CA"},children:[(0,s.jsx)("option",{value:"",children:"Select an agent…"}),a?(0,s.jsx)("option",{disabled:!0,children:"Loading…"}):Array.isArray(e)?e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id)):null]}),T.agentId&&(0,s.jsx)("div",{className:"text-xs text-red-400",children:T.agentId})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(r.U,{provider:w,model:k,onChange:e=>{S(e.provider),C(e.model)}}),(0,s.jsx)("input",{type:"hidden","data-testid":"model-input",value:k,onChange:e=>C(e.target.value)}),T.model&&(0,s.jsx)("div",{className:"text-xs text-red-400",children:T.model})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(o,{className:"text-sm",style:{color:"#3F404C"},children:"System prompt (optional)"}),(0,s.jsx)(u.g,{rows:3,value:D,onChange:e=>E(e.target.value),"data-testid":"system-prompt",className:"border",style:{borderColor:"#DFD4CA"}})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(o,{className:"text-sm",style:{color:"#3F404C"},children:"Goal (optional)"}),(0,s.jsx)(c.I,{value:A,onChange:e=>M(e.target.value),"data-testid":"goal",className:"border",style:{borderColor:"#DFD4CA"}})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(o,{className:"text-sm",style:{color:"#3F404C"},children:"User message (optional)"}),(0,s.jsx)(c.I,{value:F,onChange:e=>B(e.target.value),"data-testid":"user-message",className:"border",style:{borderColor:"#DFD4CA"}})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{onClick:U,disabled:P||!j.trim()||!k.trim()||v.length>0&&!v.includes(k.trim()),"aria-busy":P,"data-testid":"start",children:P?"Starting...":"Start battle"}),(0,s.jsxs)("div",{className:"ml-auto text-xs text-slate-400",children:["~Tokens: ",b(F,A)," | Est. cost:"," ",function(e,t,a,s){let n=b(e,t);return"$".concat((n/1e3*("openai"===a?.0015:.0012)).toFixed(4))}(F,A,w,0)]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:(0,s.jsxs)("label",{className:"inline-flex items-center gap-2",children:[(0,s.jsx)(h,{checked:J.current,onChange:e=>J.current=e.target.checked}),(0,s.jsx)("span",{children:"Auto-scroll"})]})})]}),(0,s.jsx)("section",{className:"grid gap-4",children:0===O.length?(0,s.jsx)("div",{className:"text-sm text-slate-400",children:"No sessions started yet."}):O.filter((e,t,a)=>a.findIndex(t=>t.id===e.id)===t).map(e=>(0,s.jsxs)("div",{className:"grid gap-2 rounded-[12px]",style:{background:"#fff",border:"1px solid #DFD4CA",padding:"24px",boxShadow:"0 1px 3px rgba(63,64,76,0.1), 0 1px 2px rgba(63,64,76,0.06)"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"font-semibold",style:{color:"#3F404C"},children:["Session ",e.id]}),(0,s.jsx)("div",{className:"text-xs text-slate-400",children:e.agent?"".concat(e.agent.name," \xb7 ").concat(e.provider,"/").concat(e.model):"".concat(e.provider,"/").concat(e.model)})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-400","data-testid":"status-".concat(e.id),children:["Status: ",e.status,e.endedReason?" \xb7 ended: ".concat(e.endedReason):"",e.error?" \xb7 ".concat(e.error):""]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{variant:"secondary",onClick:async()=>{try{if(!(await fetch("/api/battles/".concat(e.id,"/cancel"),{method:"POST"})).ok)throw Error("cancel_failed")}catch(t){_(t=>t.map(t=>t.id===e.id?{...t,status:"failed",endedReason:"manual"}:t))}},disabled:"succeeded"===e.status||"failed"===e.status,"data-testid":"stop-".concat(e.id),children:"Stop"}),(0,s.jsxs)("div",{className:"ml-auto text-[10px] text-slate-400",children:["messages: ",e.messages.length," / 25"]})]}),(0,s.jsx)("pre",{ref:t=>{Z.current[e.id]=t},className:"min-h-[140px] whitespace-pre-wrap rounded bg-slate-950 p-3 text-xs text-slate-200",children:e.messages.map(e=>"[".concat(e.role,"] ").concat(e.content)).join("\n")||"messages will appear here..."})]},e.id))})]}):(0,s.jsxs)("section",{className:"grid gap-3 rounded-xl bg-slate-900/70 p-4",children:[m?(0,s.jsx)("div",{className:"text-sm text-yellow-300",children:"Failed to load agents"}):null,(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(o,{className:"text-sm text-slate-300",children:"Agent"}),(0,s.jsxs)(d,{value:j,onChange:e=>N(e.target.value),"data-testid":"arena-agent-id",children:[(0,s.jsx)("option",{value:"",children:"Select an agent…"}),a?(0,s.jsx)("option",{disabled:!0,children:"Loading…"}):Array.isArray(e)?e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id)):null]})]}),(0,s.jsx)("div",{className:"grid gap-1",children:(0,s.jsx)(r.U,{provider:w,model:k,onChange:e=>{S(e.provider),C(e.model)}})}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)(o,{className:"text-sm text-slate-300",children:"Broadcast input"}),(0,s.jsx)(c.I,{value:V.broadcast,onChange:e=>V.setBroadcast(e.target.value),placeholder:"Type once to send to both A and B","data-testid":"arena-broadcast"})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-xl bg-slate-950 p-3",children:[(0,s.jsx)("div",{className:"mb-2 text-slate-300",children:"Side A"}),(0,s.jsx)(o,{className:"text-xs text-slate-400",children:"System Prompt (A)"}),(0,s.jsx)(u.g,{rows:4,value:V.promptA,onChange:e=>V.setPromptA(e.target.value),placeholder:"Hidden identity; identical styling","data-testid":"arena-prompt-a"}),(0,s.jsx)("div",{className:"mt-2 h-24 rounded bg-slate-900 p-2 text-xs text-slate-400",children:"Messages (A) will appear here…"})]}),(0,s.jsxs)("div",{className:"rounded-xl bg-slate-950 p-3",children:[(0,s.jsx)("div",{className:"mb-2 text-slate-300",children:"Side B"}),(0,s.jsx)(o,{className:"text-xs text-slate-400",children:"System Prompt (B)"}),(0,s.jsx)(u.g,{rows:4,value:V.promptB,onChange:e=>V.setPromptB(e.target.value),placeholder:"Hidden identity; identical styling","data-testid":"arena-prompt-b"}),(0,s.jsx)("div",{className:"mt-2 h-24 rounded bg-slate-900 p-2 text-xs text-slate-400",children:"Messages (B) will appear here…"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{className:"bg-purple-600 hover:bg-purple-500",onClick:en,disabled:W||!V.canStart,"aria-busy":W,"data-testid":"arena-start",children:W?"Starting…":"Start Arena"}),(0,s.jsx)(l.z,{variant:"secondary",className:"ml-auto",onClick:()=>V.setReveal(!V.reveal),disabled:!$,"data-testid":"arena-reveal",children:V.reveal?"Hide Participants":"Reveal Participants"})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-400",children:["Outcome:"," ",er?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-flex items-center gap-1 rounded px-2 py-0.5 "+("A"===er.winner?"bg-green-900/40 text-green-300":"B"===er.winner?"bg-blue-900/40 text-blue-300":"bg-slate-800 text-slate-300"),children:"tie"===er.winner?"Tie":"Winner: ".concat(er.winner)})," ","\xb7 A: ",er.a.turns," turns, ",er.a.tokens," tokens,"," ",er.a.latency,"ms median latency \xb7 B: ",er.b.turns," turns,"," ",er.b.tokens," tokens, ",er.b.latency,"ms median latency",(null==ea?void 0:ea.reasoning)?(0,s.jsxs)("span",{className:"ml-2 text-slate-300",children:["\xb7 Rationale: ",ea.reasoning]}):null]}):(0,s.jsx)("span",{className:"text-slate-300",children:"TBD"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(l.z,{variant:"secondary",onClick:()=>es({winner:"tie",reasoning:"Mocked judge: insufficient signal."}),disabled:!$,"data-testid":"arena-judge",children:"Judge (mock)"}),ea?(0,s.jsxs)("div",{className:"text-[11px] text-slate-400",children:["Judge: ",ea.winner," \xb7 ",ea.reasoning]}):null]})]})]})}function b(e,t){let a="".concat(t," ").concat(e).trim();return a?Math.ceil(a.length/4):0}},5694:function(e,t,a){"use strict";a.d(t,{U:function(){return r}});var s=a(7437),n=a(2265);function r(e){var t;let{provider:a,model:r,onChange:l}=e,[i,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/config/provider-status");if(!e.ok)throw Error("status_failed");let t=await e.json();d(t)}catch(e){d({openaiConfigured:!1,openrouterConfigured:!1,allowedModels:[]})}})()},[]);let o=(null==i?void 0:null===(t=i.allowedModels)||void 0===t?void 0:t.length)?i.allowedModels:[];return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"space-x-2",children:(0,s.jsxs)("label",{className:"text-slate-700",children:["Provider",(0,s.jsxs)("select",{value:a,onChange:e=>l({provider:e.target.value,model:r}),className:"ml-2 border border-slate-300 bg-white p-1 text-slate-900","data-testid":"pms-provider",children:[(0,s.jsx)("option",{value:"openai",children:"openai"}),(0,s.jsx)("option",{value:"openrouter",children:"openrouter"})]})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{className:"text-slate-700",children:["Model",o.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("select",{value:r,onChange:e=>l({provider:a,model:e.target.value}),className:"ml-2 border border-slate-300 bg-white p-1 text-slate-900","data-testid":"pms-model",children:o.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("input",{type:"hidden",value:r,"data-testid":"pms-model-input",readOnly:!0})]}):(0,s.jsx)("input",{value:r,onChange:e=>l({provider:a,model:e.target.value}),className:"ml-2 border border-slate-300 bg-white p-1 text-slate-900","data-testid":"pms-model-input"})]})})]})}},9733:function(e,t,a){"use strict";a.d(t,{z:function(){return l}});var s=a(7437),n=a(2265),r=a(4839);let l=n.forwardRef((e,t)=>{let{className:a,variant:n="default",size:l="md",asChild:i,children:d,...o}=e,c=(0,r.Z)("inline-flex items-center justify-center rounded transition-colors disabled:opacity-50 disabled:pointer-events-none","sm"===l&&"px-2 py-1 text-sm","md"===l&&"px-3 py-2 text-sm","lg"===l&&"px-4 py-2 text-base","default"===n&&"bg-primary text-white hover:bg-orange-500 shadow-subtle focus:outline-none focus:ring-2 focus:ring-primary","secondary"===n&&"bg-slate-700 text-slate-100 hover:bg-slate-600 shadow-subtle focus:outline-none focus:ring-2 focus:ring-primary/50","ghost"===n&&"bg-transparent text-slate-100 hover:bg-slate-800","destructive"===n&&"bg-red-600 text-white hover:bg-red-500 focus:outline-none focus:ring-2 focus:ring-red-500/60","outline"===n&&"border border-slate-700 text-slate-100 hover:bg-slate-800 focus:outline-none focus:ring-2 focus:ring-primary/50",a);return i?(0,s.jsx)("span",{className:c,children:d}):(0,s.jsx)("button",{ref:t,className:c,...o,children:d})});l.displayName="Button"},7209:function(e,t,a){"use strict";a.d(t,{I:function(){return l}});var s=a(7437),n=a(2265),r=a(4839);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("input",{ref:t,className:(0,r.Z)("w-full rounded bg-slate-800 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-primary border border-slate-700",a),...n})});l.displayName="Input"},4919:function(e,t,a){"use strict";a.d(t,{g:function(){return l}});var s=a(7437),n=a(2265),r=a(4839);let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,s.jsx)("textarea",{ref:t,className:(0,r.Z)("w-full rounded bg-slate-800 p-2 text-sm outline-none focus:ring-2 focus:ring-primary border border-slate-700",a),...n})});l.displayName="Textarea"},4839:function(e,t,a){"use strict";t.Z=function(){for(var e,t,a=0,s="",n=arguments.length;a<n;a++)(e=arguments[a])&&(t=function e(t){var a,s,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(s=e(t[a]))&&(n&&(n+=" "),n+=s)}else for(s in t)t[s]&&(n&&(n+=" "),n+=s)}return n}(e))&&(s&&(s+=" "),s+=t);return s}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=6985)}),_N_E=e.O()}]);