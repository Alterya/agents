(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[325],{6985:function(e,t,a){Promise.resolve().then(a.bind(a,1762))},1762:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var s=a(7437),n=a(2265),l=a(5694);function i(){let[e,t]=(0,n.useState)([]),[a,i]=(0,n.useState)(!0),[d,c]=(0,n.useState)(null),[o,u]=(0,n.useState)([]),[m,g]=(0,n.useState)(""),[p,x]=(0,n.useState)("openai"),[h,f]=(0,n.useState)(""),[b,v]=(0,n.useState)(""),[j,y]=(0,n.useState)(""),[N,w]=(0,n.useState)(""),[S,k]=(0,n.useState)(!1),[A,C]=(0,n.useState)({}),[M,E]=(0,n.useState)([]),B=(0,n.useRef)(!0),P=(0,n.useRef)({}),T=(0,n.useRef)(!1);(0,n.useEffect)(()=>{try{let e=JSON.parse(localStorage.getItem("hub.form")||"{}");e.agentId&&g(e.agentId),e.provider&&x(e.provider),e.model&&f(e.model),e.goal&&v(e.goal),e.systemPrompt&&y(e.systemPrompt),e.userMessage&&w(e.userMessage);let t=JSON.parse(localStorage.getItem("hub.sessions")||"[]");Array.isArray(t)&&t.length&&E(t)}catch(e){}},[]),(0,n.useEffect)(()=>{try{localStorage.setItem("hub.form",JSON.stringify({agentId:m,provider:p,model:h,goal:b,systemPrompt:j,userMessage:N}))}catch(e){}},[m,p,h,b,j,N]),(0,n.useEffect)(()=>{try{localStorage.setItem("hub.sessions",JSON.stringify(M))}catch(e){}},[M]),(0,n.useEffect)(()=>()=>{T.current=!0},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/agents",{cache:"no-store"});if(!e.ok)throw Error("agents_failed");let a=await e.json();t(a.items)}catch(e){t([]),c((null==e?void 0:e.message)||"Failed to load agents")}finally{i(!1)}})()},[]),(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/config/provider-status",{cache:"no-store"});if(!e.ok)return;let t=await e.json();u(Array.isArray(t.allowedModels)?t.allowedModels:[])}catch(e){u([])}})()},[j]);let O=(0,n.useCallback)(()=>{let e={};return m.trim()||(e.agentId="Agent ID is required"),h.trim()||(e.model="Model is required"),h.trim()&&o.length>0&&!o.includes(h.trim())&&(e.model="Model not allowed"),C(e),0===Object.keys(e).length},[m,h,o]),R=(0,n.useCallback)(e=>{let t=!1,a=0,s=0;function n(e){let t=0;for(let a=0;a<e.length;a++)t=(t+e.charCodeAt(a))%9973;return t%400}async function l(i){if(t||T.current)return;try{let t=await fetch("/api/battles/".concat(e,"/status?format=json"),{cache:"no-store"});if(429===t.status||t.status>=500){let t=Math.min((null!=i?i:1200)*2,5e3);setTimeout(()=>l(t),t+n(e));return}if(!t.ok)throw Error("status_failed");let d=await t.json();"number"==typeof d.updatedAt&&(d.updatedAt===s?a+=1:(a=0,s=d.updatedAt)),E(t=>t.map(t=>t.id!==e||t.endedReason?t:{...t,status:d.status,error:d.error}));let c=d.data,o=null==c?void 0:c.conversationId;if(o){let t=await fetch("/api/battles/".concat(o,"/messages?page=1&limit=100"),{cache:"no-store"});if(t.ok){let a=await t.json();E(t=>t.map(t=>t.id!==e||t.endedReason?t:{...t,conversationId:o,messages:a.items}))}}if("succeeded"===d.status||"failed"===d.status){var r;let t=null===(r=d.data)||void 0===r?void 0:r.endedReason;E(a=>a.map(a=>a.id===e?{...a,endedReason:t}:a));return}}catch(e){}let d=a>=3?3500:1200;setTimeout(()=>l(),(null!=i?i:d)+n(e))}return setTimeout(()=>l(),n(e)),()=>{t=!0}},[]),D=(0,n.useCallback)(async()=>{if(O()){k(!0);try{let t=await fetch("/api/battles/start",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({agentId:m,provider:p,model:h,goal:b,systemPrompt:j,userMessage:N})}),a=await t.json();if(!t.ok||"error"in a){let t=(null==a?void 0:a.error)==="invalid_agent"?"Selected agent is invalid or not found":"Failed to start",s="err-".concat(Date.now());E(a=>[...a,{id:s,provider:p,model:h,status:"failed",error:t,goal:b,userMessage:N,messages:[],agent:e.find(e=>e.id===m)}]);return}let s=a.id,n={id:s,provider:p,model:h,goal:b,userMessage:N,status:"pending",agent:e.find(e=>e.id===m),messages:[],polling:!0};E(e=>e.some(e=>e.id===s)?e.map(e=>e.id===s?{...e,...n}:e):[...e,n]),R(s)}catch(a){let t="err-".concat(Date.now());E(s=>[...s,{id:t,provider:p,model:h,status:"failed",error:(null==a?void 0:a.message)||String(a),goal:b,userMessage:N,messages:[],agent:e.find(e=>e.id===m)}])}finally{k(!1)}}},[e,m,p,h,b,N,O,R,j]);(0,n.useEffect)(()=>{function e(e){let t=navigator.platform.toLowerCase().includes("mac")?e.metaKey:e.ctrlKey;if(t&&"Enter"===e.key&&m.trim()&&h.trim()&&!S&&(e.preventDefault(),D()),!t&&("s"===e.key||"S"===e.key)){let t=[...M].reverse().find(e=>"succeeded"!==e.status&&"failed"!==e.status);t&&(e.preventDefault(),fetch("/api/battles/".concat(t.id,"/cancel"),{method:"POST"}).catch(()=>{E(e=>e.map(e=>e.id===t.id?{...e,status:"failed",endedReason:"manual"}:e))}))}}return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m,h,S,D,M]),(0,n.useEffect)(()=>{B.current&&M.forEach(e=>{let t=P.current[e.id];t&&(t.scrollTop=t.scrollHeight)})},[M]);let[I,_]=(0,n.useState)("hub"),F=function(e){let{agentId:t,provider:a,model:s,allowedModels:l}=e,[i,r]=(0,n.useState)(""),[d,c]=(0,n.useState)(""),[o,u]=(0,n.useState)(""),[m,g]=(0,n.useState)(!1),[p,x]=(0,n.useState)(!1),[h,f]=(0,n.useState)(!1),b=(0,n.useMemo)(()=>{let e=s.trim();return!!e&&(!l||0===l.length||l.includes(e))},[s,l]),v=(0,n.useMemo)(()=>!!(t.trim()&&b&&i.trim()),[t,b,i]),j=(0,n.useCallback)(async()=>{if(v&&!h){f(!0);try{x(!0),g(!1)}finally{f(!1)}}},[v,h]);return{broadcast:i,setBroadcast:r,promptA:d,setPromptA:c,promptB:o,setPromptB:u,reveal:m,setReveal:g,isRunning:p,isStarting:h,canStart:v,startArena:j}}({agentId:m,provider:p,model:h,allowedModels:o}),[J,H]=(0,n.useState)(!1),[L,U]=(0,n.useState)(!1),[q,K]=(0,n.useState)(null),[W,G]=(0,n.useState)(null),[$,z]=(0,n.useState)(null),Q=(0,n.useCallback)(async()=>{if(!J&&m.trim()&&h.trim()&&(!(o.length>0)||o.includes(h.trim()))&&F.broadcast.trim()){H(!0);try{let t={"content-type":"application/json"},a={agentId:m,provider:p,model:h,userMessage:F.broadcast},s=await fetch("/api/battles/start",{method:"POST",headers:t,body:JSON.stringify({...a,systemPrompt:F.promptA||void 0})}),n=await s.json(),l=!1;if(!s.ok||n.error){let t="arena-A-".concat(Date.now());E(a=>[...a,{id:t,provider:p,model:h,status:"failed",error:"Failed to start (A)",messages:[],agent:e.find(e=>e.id===m)}])}else{let t=n.id,a={id:t,provider:p,model:h,status:"pending",agent:e.find(e=>e.id===m),messages:[],polling:!0};E(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?{...e,...a}:e):[...e,a]),K(t),R(t),l=!0}let i=await fetch("/api/battles/start",{method:"POST",headers:t,body:JSON.stringify({...a,systemPrompt:F.promptB||void 0})}),r=await i.json(),d=!1;if(!i.ok||r.error){let t="arena-B-".concat(Date.now());E(a=>[...a,{id:t,provider:p,model:h,status:"failed",error:"Failed to start (B)",messages:[],agent:e.find(e=>e.id===m)}])}else{let t=r.id,a={id:t,provider:p,model:h,status:"pending",agent:e.find(e=>e.id===m),messages:[],polling:!0};E(e=>e.some(e=>e.id===t)?e.map(e=>e.id===t?{...e,...a}:e):[...e,a]),G(t),R(t),d=!0}U(l&&d)}catch(e){}finally{H(!1)}}},[J,m,p,h,o,F.broadcast,F.promptA,F.promptB,e,R]),V=(0,n.useMemo)(()=>{if(!q||!W)return null;let e=M.find(e=>e.id===q),t=M.find(e=>e.id===W);if(!e||!t)return null;function a(e){let t=e.map(e=>e.content).join(" ");return t?Math.ceil(t.length/4):0}function s(e){let t=[];for(let a=1;a<e.length;a++){let s=Date.parse(e[a-1].createdAt),n=Date.parse(e[a].createdAt);Number.isNaN(s)||Number.isNaN(n)||!(n>=s)||t.push(n-s)}if(!t.length)return 0;t.sort((e,t)=>e-t);let a=Math.floor(t.length/2);return t.length%2?t[a]:Math.floor((t[a-1]+t[a])/2)}function n(e){let t=[];for(let a=1;a<e.length;a++){let s=Date.parse(e[a-1].createdAt),n=Date.parse(e[a].createdAt);Number.isNaN(s)||Number.isNaN(n)||!(n>=s)||t.push(n-s)}return t.length?Math.ceil(t.reduce((e,t)=>e+t,0)/t.length):0}function l(e){return e.length}let i={terminal:"succeeded"===e.status||"failed"===e.status,succeeded:"succeeded"===e.status||"goal"===e.endedReason,turns:l(e.messages),tokens:a(e.messages),latency:s(e.messages),tokensPerTurn:(()=>{let t=l(e.messages);return t>0?Math.ceil(a(e.messages)/t):0})(),latencyPerTurn:n(e.messages)},r={terminal:"succeeded"===t.status||"failed"===t.status,succeeded:"succeeded"===t.status||"goal"===t.endedReason,turns:l(t.messages),tokens:a(t.messages),latency:s(t.messages),tokensPerTurn:(()=>{let e=l(t.messages);return e>0?Math.ceil(a(t.messages)/e):0})(),latencyPerTurn:n(t.messages)},d="tie";return d=i.succeeded&&!r.succeeded?"A":!i.succeeded&&r.succeeded?"B":i.succeeded&&r.succeeded?i.turns!==r.turns?i.turns<r.turns?"A":"B":i.tokens!==r.tokens?i.tokens<r.tokens?"A":"B":i.latency!==r.latency?i.latency<r.latency?"A":"B":"tie":"tie",{a:i,b:r,winner:d}},[q,W,M]);return(0,n.useEffect)(()=>{if(!V)return;let{a:e,b:t,winner:a}=V,s="";if("tie"===a)s="Tie: either both failed or all metrics equal.";else if("A"===a||"B"===a){let n="A"===a?e:t,l="A"===a?t:e;s=n.succeeded&&!l.succeeded?"".concat(a," succeeded while the other did not."):n.turns!==l.turns?"".concat(a," used fewer turns (").concat(n.turns," < ").concat(l.turns,")."):n.tokens!==l.tokens?"".concat(a," used fewer tokens (").concat(n.tokens," < ").concat(l.tokens,")."):n.latency!==l.latency?"".concat(a," had lower median latency (").concat(n.latency,"ms < ").concat(l.latency,"ms)."):"".concat(a," is marginally ahead on tie-breakers.")}z({winner:a,reasoning:s})},[V]),(0,s.jsxs)("main",{className:"p-6 grid gap-4 max-w-5xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-2xl text-blue-300",children:"Agent Wars Hub"}),(0,s.jsxs)("div",{className:"flex gap-2 text-sm",children:[(0,s.jsx)("button",{className:"px-3 py-1 rounded ".concat("hub"===I?"bg-blue-600":"bg-slate-700"),onClick:()=>_("hub"),children:"Hub"}),(0,s.jsx)("button",{className:"px-3 py-1 rounded ".concat("arena"===I?"bg-blue-600":"bg-slate-700"),onClick:()=>_("arena"),children:"Arena (A/B)"})]}),"hub"===I?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("section",{className:"bg-slate-900/70 rounded-xl p-4 grid gap-3",children:[d?(0,s.jsx)("div",{className:"text-sm text-yellow-300",children:"Failed to load agents"}):null,(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"Agent"}),(0,s.jsxs)("select",{className:"rounded bg-slate-800 px-3 py-2 outline-none focus:ring-2 ring-blue-500",value:m,onChange:e=>g(e.target.value),"data-testid":"agent-id",children:[(0,s.jsx)("option",{value:"",children:"Select an agent…"}),a?(0,s.jsx)("option",{disabled:!0,children:"Loading…"}):Array.isArray(e)?e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id)):null]}),A.agentId&&(0,s.jsx)("div",{className:"text-xs text-red-400",children:A.agentId})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)(l.U,{provider:p,model:h,onChange:e=>{x(e.provider),f(e.model)}}),(0,s.jsx)("input",{type:"hidden","data-testid":"model-input",value:h,onChange:()=>{}}),A.model&&(0,s.jsx)("div",{className:"text-xs text-red-400",children:A.model})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"System prompt (optional)"}),(0,s.jsx)("textarea",{className:"w-full rounded bg-slate-800 p-2 outline-none focus:ring-2 ring-blue-500 text-sm",rows:3,value:j,onChange:e=>y(e.target.value),"data-testid":"system-prompt"})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"Goal (optional)"}),(0,s.jsx)("input",{className:"rounded bg-slate-800 px-3 py-2 outline-none focus:ring-2 ring-blue-500",value:b,onChange:e=>v(e.target.value),"data-testid":"goal"})]}),(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"User message (optional)"}),(0,s.jsx)("input",{className:"rounded bg-slate-800 px-3 py-2 outline-none focus:ring-2 ring-blue-500",value:N,onChange:e=>w(e.target.value),"data-testid":"user-message"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"inline-flex items-center justify-center rounded bg-blue-600 px-4 py-2 hover:bg-blue-500 disabled:opacity-50",onClick:D,disabled:S||!m.trim()||!h.trim()||o.length>0&&!o.includes(h.trim()),"aria-busy":S,"data-testid":"start",children:S?"Starting...":"Start battle"}),(0,s.jsxs)("div",{className:"ml-auto text-xs text-slate-400",children:["~Tokens: ",r(N,b)," | Est. cost: ",function(e,t,a,s){let n=r(e,t);return"$".concat((n/1e3*("openai"===a?.0015:.0012)).toFixed(4))}(N,b,p,0)]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-xs text-slate-400",children:(0,s.jsxs)("label",{className:"inline-flex items-center gap-1",children:[(0,s.jsx)("input",{type:"checkbox",defaultChecked:!0,onChange:e=>B.current=e.target.checked}),"Auto-scroll"]})})]}),(0,s.jsx)("section",{className:"grid gap-4",children:0===M.length?(0,s.jsx)("div",{className:"text-sm text-slate-400",children:"No sessions started yet."}):M.filter((e,t,a)=>a.findIndex(t=>t.id===e.id)===t).map(e=>(0,s.jsxs)("div",{className:"bg-slate-900/70 rounded-xl p-4 grid gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("h2",{className:"text-blue-400",children:["Session ",e.id]}),(0,s.jsx)("div",{className:"text-xs text-slate-400",children:e.agent?"".concat(e.agent.name," \xb7 ").concat(e.provider,"/").concat(e.model):"".concat(e.provider,"/").concat(e.model)})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-400","data-testid":"status-".concat(e.id),children:["Status: ",e.status,e.endedReason?" \xb7 ended: ".concat(e.endedReason):"",e.error?" \xb7 ".concat(e.error):""]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"inline-flex items-center justify-center rounded bg-slate-700 px-3 py-2 hover:bg-slate-600 disabled:opacity-50",onClick:async()=>{try{if(!(await fetch("/api/battles/".concat(e.id,"/cancel"),{method:"POST"})).ok)throw Error("cancel_failed")}catch(t){E(t=>t.map(t=>t.id===e.id?{...t,status:"failed",endedReason:"manual"}:t))}},disabled:"succeeded"===e.status||"failed"===e.status,"data-testid":"stop-".concat(e.id),children:"Stop"}),(0,s.jsxs)("div",{className:"ml-auto text-[10px] text-slate-400",children:["messages: ",e.messages.length," / 25"]})]}),(0,s.jsx)("pre",{ref:t=>{P.current[e.id]=t},className:"min-h-[140px] whitespace-pre-wrap rounded bg-slate-950 p-3 text-xs text-slate-200",children:e.messages.map(e=>"[".concat(e.role,"] ").concat(e.content)).join("\n")||"messages will appear here..."})]},e.id))})]}):(0,s.jsxs)("section",{className:"bg-slate-900/70 rounded-xl p-4 grid gap-3",children:[d?(0,s.jsx)("div",{className:"text-sm text-yellow-300",children:"Failed to load agents"}):null,(0,s.jsxs)("div",{className:"grid gap-1",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"Agent"}),(0,s.jsxs)("select",{className:"rounded bg-slate-800 px-3 py-2 outline-none focus:ring-2 ring-blue-500",value:m,onChange:e=>g(e.target.value),"data-testid":"arena-agent-id",children:[(0,s.jsx)("option",{value:"",children:"Select an agent…"}),a?(0,s.jsx)("option",{disabled:!0,children:"Loading…"}):Array.isArray(e)?e.map(e=>(0,s.jsx)("option",{value:e.id,children:e.name},e.id)):null]})]}),(0,s.jsx)("div",{className:"grid gap-1",children:(0,s.jsx)(l.U,{provider:p,model:h,onChange:e=>{x(e.provider),f(e.model)}})}),(0,s.jsxs)("div",{className:"grid gap-2",children:[(0,s.jsx)("label",{className:"text-sm text-slate-300",children:"Broadcast input"}),(0,s.jsx)("input",{className:"rounded bg-slate-800 px-3 py-2 outline-none focus:ring-2 ring-blue-500",value:F.broadcast,onChange:e=>F.setBroadcast(e.target.value),placeholder:"Type once to send to both A and B","data-testid":"arena-broadcast"})]}),(0,s.jsxs)("div",{className:"grid gap-3 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-xl bg-slate-950 p-3",children:[(0,s.jsx)("div",{className:"text-slate-300 mb-2",children:"Side A"}),(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"System Prompt (A)"}),(0,s.jsx)("textarea",{className:"w-full rounded bg-slate-900 p-2 text-sm",rows:4,value:F.promptA,onChange:e=>F.setPromptA(e.target.value),placeholder:"Hidden identity; identical styling","data-testid":"arena-prompt-a"}),(0,s.jsx)("div",{className:"mt-2 h-24 rounded bg-slate-900 p-2 text-xs text-slate-400",children:"Messages (A) will appear here…"})]}),(0,s.jsxs)("div",{className:"rounded-xl bg-slate-950 p-3",children:[(0,s.jsx)("div",{className:"text-slate-300 mb-2",children:"Side B"}),(0,s.jsx)("label",{className:"text-xs text-slate-400",children:"System Prompt (B)"}),(0,s.jsx)("textarea",{className:"w-full rounded bg-slate-900 p-2 text-sm",rows:4,value:F.promptB,onChange:e=>F.setPromptB(e.target.value),placeholder:"Hidden identity; identical styling","data-testid":"arena-prompt-b"}),(0,s.jsx)("div",{className:"mt-2 h-24 rounded bg-slate-900 p-2 text-xs text-slate-400",children:"Messages (B) will appear here…"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"inline-flex items-center justify-center rounded bg-purple-600 px-4 py-2 hover:bg-purple-500 disabled:opacity-50",onClick:Q,disabled:J||!F.canStart,"aria-busy":J,"data-testid":"arena-start",children:J?"Starting…":"Start Arena"}),(0,s.jsx)("button",{className:"ml-auto inline-flex items-center justify-center rounded bg-slate-700 px-3 py-2 disabled:opacity-50",onClick:()=>F.setReveal(!F.reveal),disabled:!L,"data-testid":"arena-reveal",children:F.reveal?"Hide Participants":"Reveal Participants"})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-400",children:["Outcome: ",V?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"inline-flex items-center gap-1 rounded px-2 py-0.5 "+("A"===V.winner?"bg-green-900/40 text-green-300":"B"===V.winner?"bg-blue-900/40 text-blue-300":"bg-slate-800 text-slate-300"),children:"tie"===V.winner?"Tie":"Winner: ".concat(V.winner)})," ","\xb7 A: ",V.a.turns," turns, ",V.a.tokens," tokens, ",V.a.latency,"ms median latency"," ","\xb7 B: ",V.b.turns," turns, ",V.b.tokens," tokens, ",V.b.latency,"ms median latency",(null==$?void 0:$.reasoning)?(0,s.jsxs)("span",{className:"ml-2 text-slate-300",children:["\xb7 Rationale: ",$.reasoning]}):null]}):(0,s.jsx)("span",{className:"text-slate-300",children:"TBD"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("button",{className:"inline-flex items-center justify-center rounded bg-slate-700 px-3 py-2 disabled:opacity-50",onClick:()=>z({winner:"tie",reasoning:"Mocked judge: insufficient signal."}),disabled:!L,"data-testid":"arena-judge",children:"Judge (mock)"}),$?(0,s.jsxs)("div",{className:"text-[11px] text-slate-400",children:["Judge: ",$.winner," \xb7 ",$.reasoning]}):null]})]})]})}function r(e,t){let a="".concat(t," ").concat(e).trim();return a?Math.ceil(a.length/4):0}},5694:function(e,t,a){"use strict";a.d(t,{U:function(){return l}});var s=a(7437),n=a(2265);function l(e){var t;let{provider:a,model:l,onChange:i}=e,[r,d]=(0,n.useState)(null);(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/config/provider-status");if(!e.ok)throw Error("status_failed");let t=await e.json();d(t)}catch(e){d({openaiConfigured:!1,openrouterConfigured:!1,allowedModels:[]})}})()},[]);let c=(null==r?void 0:null===(t=r.allowedModels)||void 0===t?void 0:t.length)?r.allowedModels:[];return(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("div",{className:"space-x-2",children:(0,s.jsxs)("label",{children:["Provider",(0,s.jsxs)("select",{value:a,onChange:e=>i({provider:e.target.value,model:l}),className:"ml-2 border p-1","data-testid":"pms-provider",children:[(0,s.jsx)("option",{value:"openai",children:"openai"}),(0,s.jsx)("option",{value:"openrouter",children:"openrouter"})]})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Model",c.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("select",{value:l,onChange:e=>i({provider:a,model:e.target.value}),className:"ml-2 border p-1","data-testid":"pms-model",children:c.map(e=>(0,s.jsx)("option",{value:e,children:e},e))}),(0,s.jsx)("input",{type:"hidden",value:l,"data-testid":"pms-model-input",readOnly:!0})]}):(0,s.jsx)("input",{value:l,onChange:e=>i({provider:a,model:e.target.value}),className:"ml-2 border p-1","data-testid":"pms-model-input"})]})})]})}}},function(e){e.O(0,[971,23,744],function(){return e(e.s=6985)}),_N_E=e.O()}]);