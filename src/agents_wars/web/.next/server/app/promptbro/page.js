(()=>{var e={};e.id=850,e.ids=[850],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6295:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>p,tree:()=>c}),t(9921),t(7218),t(5866);var a=t(3191),r=t(8716),n=t(7922),l=t.n(n),i=t(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);t.d(s,o);let c=["",{children:["promptbro",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,9921)),"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/promptbro/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7218)),"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/promptbro/page.tsx"],m="/promptbro/page",u={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/promptbro/page",pathname:"/promptbro",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},8447:(e,s,t)=>{Promise.resolve().then(t.bind(t,3102))},2715:(e,s,t)=>{Promise.resolve().then(t.bind(t,9871))},8627:(e,s,t)=>{Promise.resolve().then(t.t.bind(t,2994,23)),Promise.resolve().then(t.t.bind(t,6114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,9671,23)),Promise.resolve().then(t.t.bind(t,1868,23)),Promise.resolve().then(t.t.bind(t,4759,23))},9871:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(326),r=t(7577),n=t(7137),l=t(5360),i=t(1664),o=t(1190),c=t(2015);function d(e){let s;let t=/\{\{\s*([a-zA-Z0-9_-]+)\s*\}\}/g,a=new Set;for(;null!==(s=t.exec(e));){let e=s[1]?.trim();e&&a.add(e)}return Array.from(a)}function m(){let[e,s]=(0,r.useState)("openai"),[t,m]=(0,r.useState)("gpt-4o"),[u,p]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[f,v]=(0,r.useState)(""),[j,y]=(0,r.useState)("### INSTRUCTION\n<write here>\n\n### CONTEXT\n<write here>\n\n### OUTPUT\n<write here>"),[N,w]=(0,r.useState)(""),[S,k]=(0,r.useState)([]),[P,C]=(0,r.useState)({}),[T,_]=(0,r.useState)([]),[O,A]=(0,r.useState)(""),[M,z]=(0,r.useState)(""),[D,U]=(0,r.useState)(""),q=async()=>{h(""),z("");let s=[{role:"system",content:"You help refine prompts by asking clarifying questions."},{role:"user",content:u}],a=await fetch("/api/llm/chat",{method:"POST",headers:{"content-type":"application/json","x-assist":"promptbro"},body:JSON.stringify({provider:e,model:t,messages:s,maxTokens:128,temperature:.2})});if(!a.ok){z(429===a.status?"Assist rate limited. Try again shortly.":"Assist failed. Please try again.");return}h((await a.json()).text||"")},I=async()=>{z("");let e=d(j),s=await fetch("/api/prompt-templates",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:g,description:f,template:j,variables:e})});s.ok?k((await (await fetch("/api/prompt-templates")).json()).templates||[]):z(429===s.status?"Save rate limited. Try again later.":"Save failed. Check inputs and try again.")},R=j?j.replace(/\{\{\s*([a-zA-Z0-9_-]+)\s*\}\}/g,(e,s)=>{let t=String(s??"").trim(),a=P[t];return"string"==typeof a&&a.length>0?a:`{{${t}}}`}):"",$=d(j).filter(e=>!(P[e]??"").trim()),E=e=>{let s=[].find(s=>s.id===e);s&&(b(s.name),v(s.description||""),y(s.template))},J=e=>{[].filter(s=>s.id!==e),_(s=>s.filter(s=>s.id!==e))},W=async()=>{try{await navigator.clipboard.writeText(R),U("Assembled prompt copied"),setTimeout(()=>U(""),1500)}catch{}},B=async()=>{var e;let s=JSON.stringify({name:(e={name:g||"unnamed",template:j,variables:d(j)}).name,template:e.template,variables:e.variables,exportedAt:new Date().toISOString(),version:1},null,2);try{await navigator.clipboard.writeText(s),U("Template JSON copied"),setTimeout(()=>U(""),1500)}catch{}};return(0,a.jsxs)("main",{className:"space-y-4 p-6",children:[a.jsx("h1",{className:"text-xl font-semibold",children:"PromptBro"}),a.jsx(n.x,{}),a.jsx("div",{className:"space-y-2",children:a.jsx(l.U,{provider:e,model:t,onChange:e=>{s(e.provider),m(e.model)}})}),(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-lg font-medium",children:"Describe your task"}),M&&a.jsx("div",{role:"alert",className:"rounded border border-red-600 bg-red-950/40 p-2 text-sm text-red-300",children:M}),D&&a.jsx("div",{role:"status",className:"rounded border border-emerald-600 bg-emerald-950/40 p-2 text-sm text-emerald-300",children:D}),a.jsx(c.g,{className:"border",rows:4,value:u,onChange:e=>p(e.target.value),"aria-label":"Describe your task"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:q,children:"Ask clarifying question"}),a.jsx("pre",{className:"min-h-24 whitespace-pre-wrap break-words border p-2",children:x})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-lg font-medium",children:"Draft Template"}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsxs)("label",{children:["Name",a.jsx(o.I,{className:"ml-2 border",value:g,onChange:e=>b(e.target.value)})]}),(0,a.jsxs)("label",{children:["Description",a.jsx(o.I,{className:"ml-2 border",value:f,onChange:e=>v(e.target.value)})]})]}),(0,a.jsxs)("div",{className:"space-y-1",children:[a.jsx("div",{className:"text-sm text-gray-600",children:"Derived variables"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[0===Object.keys(P).length&&a.jsx("span",{className:"text-sm text-gray-500",children:"No variables detected"}),Object.entries(P).map(([e,s])=>(0,a.jsxs)("label",{className:"text-sm",children:[(0,a.jsxs)("span",{className:"mr-1 font-medium",children:[`{{${e}}}`,":"]}),a.jsx(o.I,{className:"border",placeholder:`value for ${e}`,value:s,onChange:s=>C(t=>({...t,[e]:s.target.value}))})]},e))]})]}),a.jsx(c.g,{className:"w-full border",rows:10,value:j,onChange:e=>y(e.target.value),"aria-label":"Draft Template"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:I,children:"Save template"}),$.length>0&&a.jsx("div",{className:"text-sm text-red-600",children:`Missing values for: ${$.join(", ")}`}),O&&a.jsx("div",{className:"text-xs text-gray-500",children:O}),(0,a.jsxs)("div",{className:"space-x-2",children:[a.jsx(i.z,{className:"border",variant:"secondary",onClick:()=>{let e=function(e,s={}){let t=Math.max(1,s.maxCount??10),a={id:globalThis.crypto?.randomUUID?.()??`v_${Date.now()}_${Math.random().toString(36).slice(2)}`,timestamp:Date.now(),name:e.name,description:e.description,template:e.template,variables:[...e.variables]};return[a].slice(0,t),a}({name:g||"unnamed",description:f,template:j,variables:d(j)});_(s=>[e,...s]),U("Version saved"),setTimeout(()=>U(""),1500)},children:"Save version"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:W,children:"Copy assembled"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:B,children:"Export JSON"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:()=>{b(""),v(""),y("### INSTRUCTION\n<write here>\n\n### CONTEXT\n<write here>\n\n### OUTPUT\n<write here>"),C({});try{window.localStorage.removeItem("promptbro:lastDraft")}catch{}},children:"Reset draft"})]}),(0,a.jsxs)("div",{children:[a.jsx("h3",{className:"mt-2 text-base font-medium",children:"Assembled Preview"}),a.jsx("pre",{className:"min-h-24 whitespace-pre-wrap break-words border p-2",children:R})]})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-lg font-medium",children:"Versions"}),(0,a.jsxs)("ul",{className:"list-disc pl-6",children:[0===T.length&&a.jsx("li",{className:"text-sm text-gray-500",children:"No versions saved"}),T.map(e=>(0,a.jsxs)("li",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:e.name}),a.jsx("span",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()}),a.jsx(i.z,{className:"border",size:"sm",variant:"secondary",onClick:()=>E(e.id),children:"Restore"}),a.jsx(i.z,{className:"border",size:"sm",variant:"secondary",onClick:()=>J(e.id),children:"Delete"})]},e.id))]})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-lg font-medium",children:"Quick Checks"}),a.jsx(i.z,{className:"border",variant:"secondary",onClick:()=>{let e=function(e){let s=[],t=d(e);e.length>2e4&&s.push({id:"size",severity:"high",message:"Template exceeds size limits",hint:"Reduce length below 20k characters."});let a=e.toLowerCase();a.includes("audience")||a.includes("user")||s.push({id:"audience",severity:"medium",message:"Audience not specified",hint:"Mention who the output is for (e.g., developer, end-user)."}),a.includes("success")||a.includes("criteria")||s.push({id:"success",severity:"medium",message:"Missing success criteria",hint:"Define what a good answer looks like."}),a.includes("format")||a.includes("json")||a.includes("markdown")||s.push({id:"format",severity:"low",message:"Output format not specified",hint:"Ask for JSON, Markdown, or a specific structure."}),/ignore\s+previous|system:|jailbreak/i.test(e)&&s.push({id:"injection",severity:"high",message:"Potential prompt injection markers detected",hint:"Remove instructions that subvert prior rules."}),t.length>0&&s.push({id:"variables",severity:"low",message:`Detected variables: ${t.join(", ")}`,hint:"Ensure these are provided before running."});let r=100;for(let e of s)"high"===e.severity?r-=30:"medium"===e.severity?r-=15:r-=5;return{issues:s,score:r=Math.max(0,Math.min(100,r))}}(j);e.issues.some(e=>"high"===e.severity)?U(`Checks: ${e.issues.length} issues, score ${e.score}/100`):U(`Checks passed with score ${e.score}/100`),setTimeout(()=>U(""),2e3)},children:"Run Quick Checks"})]}),(0,a.jsxs)("section",{className:"space-y-2",children:[a.jsx("h2",{className:"text-lg font-medium",children:"Saved Templates"}),a.jsx("ul",{className:"list-disc pl-6",children:S.map(e=>(0,a.jsxs)("li",{children:[a.jsx("span",{className:"font-medium",children:e.name})," — ",e.description||""]},e.id))})]})]})}},7137:(e,s,t)=>{"use strict";t.d(s,{x:()=>n});var a=t(326),r=t(7577);function n(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(null);if(t)return a.jsx("div",{className:"border bg-yellow-50 p-2 text-sm text-yellow-800",children:t});if(!e)return null;let l=[];return(e.openaiConfigured||l.push("OpenAI"),e.openrouterConfigured||l.push("OpenRouter"),0===l.length)?null:(0,a.jsxs)("div",{className:"border bg-yellow-50 p-2 text-sm text-yellow-800",children:["Missing provider configuration: ",l.join(", "),". Some features may be limited."]})}},5360:(e,s,t)=>{"use strict";t.d(s,{U:()=>n});var a=t(326),r=t(7577);function n(e){let{provider:s,model:t,onChange:n}=e,[l,i]=(0,r.useState)(null),o=l?.allowedModels?.length?l.allowedModels:[];return(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("div",{className:"space-x-2",children:(0,a.jsxs)("label",{children:["Provider",(0,a.jsxs)("select",{value:s,onChange:e=>n({provider:e.target.value,model:t}),className:"ml-2 border p-1","data-testid":"pms-provider",children:[a.jsx("option",{value:"openai",children:"openai"}),a.jsx("option",{value:"openrouter",children:"openrouter"})]})]})}),a.jsx("div",{children:(0,a.jsxs)("label",{children:["Model",o.length>0?(0,a.jsxs)(a.Fragment,{children:[a.jsx("select",{value:t,onChange:e=>n({provider:s,model:e.target.value}),className:"ml-2 border p-1","data-testid":"pms-model",children:o.map(e=>a.jsx("option",{value:e,children:e},e))}),a.jsx("input",{type:"hidden",value:t,"data-testid":"pms-model-input",readOnly:!0})]}):a.jsx("input",{value:t,onChange:e=>n({provider:s,model:e.target.value}),className:"ml-2 border p-1","data-testid":"pms-model-input"})]})})]})}},3102:(e,s,t)=>{"use strict";t.d(s,{default:()=>o});var a=t(326),r=t(434),n=t(5047),l=t(7577),i=t(1664);function o(){let e=(0,n.usePathname)(),[s,t]=(0,l.useState)(!1),o=[{href:"/hub",label:"Hub"},{href:"/scale",label:"Scale"},{href:"/promptbro",label:"PromptBro"},{href:"/debug/llm",label:"LLM Debug"}];return(0,a.jsxs)("header",{className:"sticky top-0 z-40 border-b border-slate-800/80 bg-slate-950/80 backdrop-blur",children:[(0,a.jsxs)("div",{className:"mx-auto flex max-w-6xl items-center justify-between gap-4 px-4 py-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[a.jsx(r.default,{href:"/",className:"text-lg font-semibold text-blue-300",children:"Agent Wars"}),a.jsx("span",{className:"hidden text-xs text-slate-300 sm:inline",children:"v0"})]}),a.jsx("div",{className:"hidden items-center gap-2 text-sm sm:flex",children:o.map(s=>a.jsx(r.default,{href:s.href,className:"rounded px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 "+(e?.startsWith(s.href)?"bg-blue-600 text-white":"text-slate-200 hover:bg-slate-800"),children:s.label},s.href))}),a.jsx("div",{className:"sm:hidden",children:a.jsx(i.z,{"aria-label":"Menu",variant:"secondary",onClick:()=>t(e=>!e),children:"Menu"})})]}),s?a.jsx("nav",{"aria-label":"Mobile",className:"sm:hidden",children:a.jsx("div",{className:"mx-auto grid max-w-6xl gap-1 px-4 pb-3",children:o.map(s=>a.jsx(r.default,{href:s.href,onClick:()=>t(!1),className:"rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 "+(e?.startsWith(s.href)?"bg-blue-600 text-white":"text-slate-200 hover:bg-slate-800"),children:s.label},s.href))})}):null]})}},1664:(e,s,t)=>{"use strict";t.d(s,{z:()=>l});var a=t(326),r=t(7577),n=t(1135);let l=r.forwardRef(({className:e,variant:s="default",size:t="md",...r},l)=>a.jsx("button",{ref:l,className:(0,n.Z)("inline-flex items-center justify-center rounded transition-colors disabled:opacity-50 disabled:pointer-events-none","sm"===t&&"px-2 py-1 text-sm","md"===t&&"px-3 py-2 text-sm","lg"===t&&"px-4 py-2 text-base","default"===s&&"bg-blue-600 text-white hover:bg-blue-500","secondary"===s&&"bg-slate-700 text-slate-100 hover:bg-slate-600","ghost"===s&&"bg-transparent text-slate-100 hover:bg-slate-800","destructive"===s&&"bg-red-600 text-white hover:bg-red-500","outline"===s&&"border border-slate-700 text-slate-100 hover:bg-slate-800",e),...r}));l.displayName="Button"},1190:(e,s,t)=>{"use strict";t.d(s,{I:()=>l});var a=t(326),r=t(7577),n=t(1135);let l=r.forwardRef(({className:e,...s},t)=>a.jsx("input",{ref:t,className:(0,n.Z)("w-full rounded bg-slate-800 px-3 py-2 text-sm outline-none ring-blue-500 focus:ring-2",e),...s}));l.displayName="Input"},2015:(e,s,t)=>{"use strict";t.d(s,{g:()=>l});var a=t(326),r=t(7577),n=t(1135);let l=r.forwardRef(({className:e,...s},t)=>a.jsx("textarea",{ref:t,className:(0,n.Z)("w-full rounded bg-slate-800 p-2 text-sm outline-none ring-blue-500 focus:ring-2",e),...s}));l.displayName="Textarea"},7218:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m,metadata:()=>d});var a=t(9510);t(7272);var r=t(8570);let n=(0,r.createProxy)(String.raw`/Users/baramsalem/agents-repo/agents/src/agents_wars/web/src/components/layout/Header.tsx`),{__esModule:l,$$typeof:i}=n;n.default;let o=(0,r.createProxy)(String.raw`/Users/baramsalem/agents-repo/agents/src/agents_wars/web/src/components/layout/Header.tsx#default`);function c(){return a.jsx("footer",{className:"mt-12 border-t border-slate-800/80 bg-slate-950",children:a.jsx("div",{className:"mx-auto max-w-6xl px-4 py-6 text-xs text-slate-400",children:(0,a.jsxs)("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[(0,a.jsxs)("p",{children:["\xa9 ",new Date().getFullYear()," Agent Wars. Built with Next.js. Accessibility-first."]}),(0,a.jsxs)("nav",{"aria-label":"Footer",className:"flex gap-3",children:[a.jsx("a",{className:"hover:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",href:"/",children:"Home"}),a.jsx("a",{className:"hover:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",href:"/hub",children:"Hub"}),a.jsx("a",{className:"hover:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",href:"/scale",children:"Scale"}),a.jsx("a",{className:"hover:text-slate-200 focus:outline-none focus:ring-2 focus:ring-blue-500",href:"/promptbro",children:"PromptBro"})]})]})})})}let d={title:"Agent Wars",description:"Agent Wars web app"};function m({children:e}){return(0,a.jsxs)("html",{lang:"en",children:[a.jsx("head",{}),(0,a.jsxs)("body",{className:"bg-slate-950 text-slate-100",children:[a.jsx("a",{href:"#main",className:"sr-only focus:not-sr-only focus:fixed focus:left-2 focus:top-2 focus:rounded focus:bg-blue-700 focus:px-3 focus:py-2",children:"Skip to content"}),a.jsx(o,{}),a.jsx("div",{id:"main",className:"min-h-[calc(100dvh-140px)]",children:e}),a.jsx(c,{})]})]})}},9921:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var a=t(8570);let r=(0,a.createProxy)(String.raw`/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/promptbro/page.tsx`),{__esModule:n,$$typeof:l}=r;r.default;let i=(0,a.createProxy)(String.raw`/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/promptbro/page.tsx#default`)},7272:()=>{}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[948,676],()=>t(6295));module.exports=a})();