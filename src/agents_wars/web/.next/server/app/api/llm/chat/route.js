"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/llm/chat/route";
exports.ids = ["app/api/llm/chat/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fllm%2Fchat%2Froute&page=%2Fapi%2Fllm%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fllm%2Fchat%2Froute.ts&appDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fllm%2Fchat%2Froute&page=%2Fapi%2Fllm%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fllm%2Fchat%2Froute.ts&appDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_baramsalem_agents_repo_agents_src_agents_wars_web_app_api_llm_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/llm/chat/route.ts */ \"(rsc)/./app/api/llm/chat/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/llm/chat/route\",\n        pathname: \"/api/llm/chat\",\n        filename: \"route\",\n        bundlePath: \"app/api/llm/chat/route\"\n    },\n    resolvedPagePath: \"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/api/llm/chat/route.ts\",\n    nextConfigOutput,\n    userland: _Users_baramsalem_agents_repo_agents_src_agents_wars_web_app_api_llm_chat_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/llm/chat/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZsbG0lMkZjaGF0JTJGcm91dGUmcGFnZT0lMkZhcGklMkZsbG0lMkZjaGF0JTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbGxtJTJGY2hhdCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRmJhcmFtc2FsZW0lMkZhZ2VudHMtcmVwbyUyRmFnZW50cyUyRnNyYyUyRmFnZW50c193YXJzJTJGd2ViJTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRmJhcmFtc2FsZW0lMkZhZ2VudHMtcmVwbyUyRmFnZW50cyUyRnNyYyUyRmFnZW50c193YXJzJTJGd2ViJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNrQztBQUMvRztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2FnZW50LXdhcnMtd2ViLz9iYTk3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy9iYXJhbXNhbGVtL2FnZW50cy1yZXBvL2FnZW50cy9zcmMvYWdlbnRzX3dhcnMvd2ViL2FwcC9hcGkvbGxtL2NoYXQvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2xsbS9jaGF0L3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvbGxtL2NoYXRcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2xsbS9jaGF0L3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2JhcmFtc2FsZW0vYWdlbnRzLXJlcG8vYWdlbnRzL3NyYy9hZ2VudHNfd2Fycy93ZWIvYXBwL2FwaS9sbG0vY2hhdC9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvbGxtL2NoYXQvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fllm%2Fchat%2Froute&page=%2Fapi%2Fllm%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fllm%2Fchat%2Froute.ts&appDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/llm/chat/route.ts":
/*!***********************************!*\
  !*** ./app/api/llm/chat/route.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/lib/index.mjs\");\n/* harmony import */ var _lib_llm_provider__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/llm/provider */ \"(rsc)/./src/lib/llm/provider.ts\");\n/* harmony import */ var _lib_llm_guards__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/llm/guards */ \"(rsc)/./src/lib/llm/guards.ts\");\n\n\n\nconst bodySchema = zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n    provider: zod__WEBPACK_IMPORTED_MODULE_2__.z.enum([\n        \"openai\",\n        \"openrouter\"\n    ]),\n    model: zod__WEBPACK_IMPORTED_MODULE_2__.z.string().min(1),\n    messages: zod__WEBPACK_IMPORTED_MODULE_2__.z.array(zod__WEBPACK_IMPORTED_MODULE_2__.z.object({\n        role: zod__WEBPACK_IMPORTED_MODULE_2__.z.enum([\n            \"system\",\n            \"user\",\n            \"assistant\",\n            \"tool\"\n        ]),\n        content: zod__WEBPACK_IMPORTED_MODULE_2__.z.string()\n    })),\n    maxTokens: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().int().positive().optional(),\n    temperature: zod__WEBPACK_IMPORTED_MODULE_2__.z.number().min(0).max(2).optional(),\n    stream: zod__WEBPACK_IMPORTED_MODULE_2__.z.boolean().optional()\n});\nasync function POST(req) {\n    try {\n        const json = await req.json();\n        const parsed = bodySchema.safeParse(json);\n        if (!parsed.success) {\n            return new Response(JSON.stringify({\n                error: \"invalid_body\",\n                details: parsed.error.flatten()\n            }), {\n                status: 400,\n                headers: {\n                    \"content-type\": \"application/json\"\n                }\n            });\n        }\n        const { provider, model, messages, maxTokens, temperature, stream } = parsed.data;\n        // Simple per-IP rate key to complement provider+model limiter\n        const ip = req.headers.get(\"x-forwarded-for\")?.split(\",\")[0]?.trim() || \"local\";\n        // Basic per-IP limiter (e.g., 10-60 rpm via config)\n        try {\n            (0,_lib_llm_guards__WEBPACK_IMPORTED_MODULE_1__.rateLimit)(`ip:${ip}`);\n        } catch (e) {\n            if (e instanceof _lib_llm_guards__WEBPACK_IMPORTED_MODULE_1__.GuardrailsError) {\n                return new Response(JSON.stringify({\n                    error: \"rate_limited\"\n                }), {\n                    status: 429,\n                    headers: {\n                        \"content-type\": \"application/json\"\n                    }\n                });\n            }\n            throw e;\n        }\n        // Optional daily cap for PromptBro assist calls, enforced when header is present\n        const isPromptBroAssist = req.headers.get(\"x-assist\") === \"promptbro\";\n        if (isPromptBroAssist) {\n            const capRaw = process.env.PROMPTBRO_ASSIST_DAILY_CAP;\n            const cap = Math.max(1, Number(capRaw ?? 50));\n            const dayKey = new Date().toISOString().slice(0, 10);\n            // in-memory counter\n            globalThis.__pb_daily = globalThis.__pb_daily || new Map();\n            const key = `${ip}:${dayKey}`;\n            const count = globalThis.__pb_daily.get(key) ?? 0;\n            if (count >= cap) {\n                return new Response(JSON.stringify({\n                    error: \"daily_cap_reached\"\n                }), {\n                    status: 429,\n                    headers: {\n                        \"content-type\": \"application/json\"\n                    }\n                });\n            }\n            globalThis.__pb_daily.set(key, count + 1);\n        }\n        if (stream) {\n            // Preflight the chat call so we can return proper HTTP status on errors before starting SSE\n            try {\n                const res = await (0,_lib_llm_provider__WEBPACK_IMPORTED_MODULE_0__.chat)(messages, {\n                    provider,\n                    model,\n                    maxTokens: Math.min(typeof maxTokens === \"number\" ? maxTokens : 128, 128),\n                    temperature,\n                    stream: true\n                });\n                const encoder = new TextEncoder();\n                const raw = res.raw;\n                const rs = new ReadableStream({\n                    async start (controller) {\n                        try {\n                            if (raw && Symbol.asyncIterator in raw) {\n                                for await (const chunk of raw){\n                                    const delta = chunk?.choices?.[0]?.delta?.content;\n                                    if (delta) controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                                        delta\n                                    })}\\n\\n`));\n                                }\n                                controller.enqueue(encoder.encode(`data: [DONE]\\n\\n`));\n                            } else {\n                                controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                                    text: res.text\n                                })}\\n\\n`));\n                                controller.enqueue(encoder.encode(`data: [DONE]\\n\\n`));\n                            }\n                            controller.close();\n                        } catch  {\n                            controller.enqueue(encoder.encode(`event: error\\n`));\n                            controller.enqueue(encoder.encode(`data: ${JSON.stringify({\n                                error: \"stream_failed\"\n                            })}\\n\\n`));\n                            controller.close();\n                        }\n                    }\n                });\n                return new Response(rs, {\n                    status: 200,\n                    headers: {\n                        \"content-type\": \"text/event-stream; charset=utf-8\",\n                        \"cache-control\": \"no-cache, no-transform\",\n                        connection: \"keep-alive\"\n                    }\n                });\n            } catch (err) {\n                const status = mapErrorToStatus(err);\n                return new Response(JSON.stringify({\n                    error: \"chat_failed\"\n                }), {\n                    status,\n                    headers: {\n                        \"content-type\": \"application/json\"\n                    }\n                });\n            }\n        }\n        const res = await (0,_lib_llm_provider__WEBPACK_IMPORTED_MODULE_0__.chat)(messages, {\n            provider,\n            model,\n            maxTokens: Math.min(typeof maxTokens === \"number\" ? maxTokens : 128, 128),\n            temperature\n        });\n        return new Response(JSON.stringify({\n            text: res.text,\n            usage: res.usage\n        }), {\n            status: 200,\n            headers: {\n                \"content-type\": \"application/json\"\n            }\n        });\n    } catch (err) {\n        const status = mapErrorToStatus(err);\n        return new Response(JSON.stringify({\n            error: \"internal_error\"\n        }), {\n            status,\n            headers: {\n                \"content-type\": \"application/json\"\n            }\n        });\n    }\n}\nfunction mapErrorToStatus(err) {\n    if (err instanceof _lib_llm_guards__WEBPACK_IMPORTED_MODULE_1__.GuardrailsError) {\n        if (String(err.message).toLowerCase().includes(\"rate limit\")) return 429;\n        return 400;\n    }\n    const status = err?.status ?? err?.response?.status;\n    if (status === 429) return 429;\n    if (typeof status === \"number\" && status >= 500 && status <= 599) return 502;\n    return 500;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7WUFBRUMsT0FBTztRQUFpQixJQUFJO1lBQy9ERztZQUNBQyxTQUFTO2dCQUFFLGdCQUFnQjtZQUFtQjtRQUNoRDtJQUNGO0FBQ0Y7QUFFQSxTQUFTNEMsaUJBQWlCRCxHQUFRO0lBQ2hDLElBQUlBLGVBQWU5RSw0REFBZUEsRUFBRTtRQUNsQyxJQUFJaUYsT0FBT0gsSUFBSUksT0FBTyxFQUFFQyxXQUFXLEdBQUdDLFFBQVEsQ0FBQyxlQUFlLE9BQU87UUFDckUsT0FBTztJQUNUO0lBQ0EsTUFBTWxELFNBQVM0QyxLQUFLNUMsVUFBVTRDLEtBQUtPLFVBQVVuRDtJQUM3QyxJQUFJQSxXQUFXLEtBQUssT0FBTztJQUMzQixJQUFJLE9BQU9BLFdBQVcsWUFBWUEsVUFBVSxPQUFPQSxVQUFVLEtBQUssT0FBTztJQUN6RSxPQUFPO0FBQ1QiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9hZ2VudC13YXJzLXdlYi8uL2FwcC9hcGkvbGxtL2NoYXQvcm91dGUudHM/M2M1NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgeiB9IGZyb20gXCJ6b2RcIjtcbmltcG9ydCB7IGNoYXQsIHR5cGUgQ2hhdE1lc3NhZ2UgfSBmcm9tIFwiQC9saWIvbGxtL3Byb3ZpZGVyXCI7XG5pbXBvcnQgeyBHdWFyZHJhaWxzRXJyb3IsIHJhdGVMaW1pdCB9IGZyb20gXCJAL2xpYi9sbG0vZ3VhcmRzXCI7XG5cbmNvbnN0IGJvZHlTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIHByb3ZpZGVyOiB6LmVudW0oW1wib3BlbmFpXCIsIFwib3BlbnJvdXRlclwiXSksXG4gIG1vZGVsOiB6LnN0cmluZygpLm1pbigxKSxcbiAgbWVzc2FnZXM6IHouYXJyYXkoXG4gICAgei5vYmplY3QoeyByb2xlOiB6LmVudW0oW1wic3lzdGVtXCIsIFwidXNlclwiLCBcImFzc2lzdGFudFwiLCBcInRvb2xcIl0pLCBjb250ZW50OiB6LnN0cmluZygpIH0pLFxuICApLFxuICBtYXhUb2tlbnM6IHoubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5vcHRpb25hbCgpLFxuICB0ZW1wZXJhdHVyZTogei5udW1iZXIoKS5taW4oMCkubWF4KDIpLm9wdGlvbmFsKCksXG4gIHN0cmVhbTogei5ib29sZWFuKCkub3B0aW9uYWwoKSxcbn0pO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QganNvbiA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgcGFyc2VkID0gYm9keVNjaGVtYS5zYWZlUGFyc2UoanNvbik7XG4gICAgaWYgKCFwYXJzZWQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoeyBlcnJvcjogXCJpbnZhbGlkX2JvZHlcIiwgZGV0YWlsczogcGFyc2VkLmVycm9yLmZsYXR0ZW4oKSB9KSxcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogNDAwLFxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgfSxcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHsgcHJvdmlkZXIsIG1vZGVsLCBtZXNzYWdlcywgbWF4VG9rZW5zLCB0ZW1wZXJhdHVyZSwgc3RyZWFtIH0gPSBwYXJzZWQuZGF0YTtcbiAgICAvLyBTaW1wbGUgcGVyLUlQIHJhdGUga2V5IHRvIGNvbXBsZW1lbnQgcHJvdmlkZXIrbW9kZWwgbGltaXRlclxuICAgIGNvbnN0IGlwID0gcmVxLmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtZm9yXCIpPy5zcGxpdChcIixcIilbMF0/LnRyaW0oKSB8fCBcImxvY2FsXCI7XG5cbiAgICAvLyBCYXNpYyBwZXItSVAgbGltaXRlciAoZS5nLiwgMTAtNjAgcnBtIHZpYSBjb25maWcpXG4gICAgdHJ5IHtcbiAgICAgIHJhdGVMaW1pdChgaXA6JHtpcH1gKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEd1YXJkcmFpbHNFcnJvcikge1xuICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6IFwicmF0ZV9saW1pdGVkXCIgfSksIHtcbiAgICAgICAgICBzdGF0dXM6IDQyOSxcbiAgICAgICAgICBoZWFkZXJzOiB7IFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhyb3cgZTtcbiAgICB9XG5cbiAgICAvLyBPcHRpb25hbCBkYWlseSBjYXAgZm9yIFByb21wdEJybyBhc3Npc3QgY2FsbHMsIGVuZm9yY2VkIHdoZW4gaGVhZGVyIGlzIHByZXNlbnRcbiAgICBjb25zdCBpc1Byb21wdEJyb0Fzc2lzdCA9IHJlcS5oZWFkZXJzLmdldChcIngtYXNzaXN0XCIpID09PSBcInByb21wdGJyb1wiO1xuICAgIGlmIChpc1Byb21wdEJyb0Fzc2lzdCkge1xuICAgICAgY29uc3QgY2FwUmF3ID0gcHJvY2Vzcy5lbnYuUFJPTVBUQlJPX0FTU0lTVF9EQUlMWV9DQVA7XG4gICAgICBjb25zdCBjYXAgPSBNYXRoLm1heCgxLCBOdW1iZXIoY2FwUmF3ID8/IDUwKSk7XG4gICAgICBjb25zdCBkYXlLZXkgPSBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwgMTApO1xuICAgICAgLy8gaW4tbWVtb3J5IGNvdW50ZXJcbiAgICAgIChnbG9iYWxUaGlzIGFzIGFueSkuX19wYl9kYWlseSA9IChnbG9iYWxUaGlzIGFzIGFueSkuX19wYl9kYWlseSB8fCBuZXcgTWFwPHN0cmluZywgbnVtYmVyPigpO1xuICAgICAgY29uc3Qga2V5ID0gYCR7aXB9OiR7ZGF5S2V5fWA7XG4gICAgICBjb25zdCBjb3VudCA9ICgoZ2xvYmFsVGhpcyBhcyBhbnkpLl9fcGJfZGFpbHkuZ2V0KGtleSkgYXMgbnVtYmVyIHwgdW5kZWZpbmVkKSA/PyAwO1xuICAgICAgaWYgKGNvdW50ID49IGNhcCkge1xuICAgICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6IFwiZGFpbHlfY2FwX3JlYWNoZWRcIiB9KSwge1xuICAgICAgICAgIHN0YXR1czogNDI5LFxuICAgICAgICAgIGhlYWRlcnM6IHsgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIgfSxcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9fcGJfZGFpbHkuc2V0KGtleSwgY291bnQgKyAxKTtcbiAgICB9XG5cbiAgICBpZiAoc3RyZWFtKSB7XG4gICAgICAvLyBQcmVmbGlnaHQgdGhlIGNoYXQgY2FsbCBzbyB3ZSBjYW4gcmV0dXJuIHByb3BlciBIVFRQIHN0YXR1cyBvbiBlcnJvcnMgYmVmb3JlIHN0YXJ0aW5nIFNTRVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgY2hhdChtZXNzYWdlcyBhcyBDaGF0TWVzc2FnZVtdLCB7XG4gICAgICAgICAgcHJvdmlkZXIsXG4gICAgICAgICAgbW9kZWwsXG4gICAgICAgICAgbWF4VG9rZW5zOiBNYXRoLm1pbih0eXBlb2YgbWF4VG9rZW5zID09PSBcIm51bWJlclwiID8gbWF4VG9rZW5zIDogMTI4LCAxMjgpLFxuICAgICAgICAgIHRlbXBlcmF0dXJlLFxuICAgICAgICAgIHN0cmVhbTogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICAgICAgY29uc3QgcmF3OiBhbnkgPSByZXMucmF3O1xuICAgICAgICBjb25zdCBycyA9IG5ldyBSZWFkYWJsZVN0cmVhbTxVaW50OEFycmF5Pih7XG4gICAgICAgICAgYXN5bmMgc3RhcnQoY29udHJvbGxlcikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgaWYgKHJhdyAmJiBTeW1ib2wuYXN5bmNJdGVyYXRvciBpbiByYXcpIHtcbiAgICAgICAgICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHJhdyBhcyBBc3luY0l0ZXJhYmxlPGFueT4pIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGRlbHRhID0gY2h1bms/LmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICBpZiAoZGVsdGEpXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogJHtKU09OLnN0cmluZ2lmeSh7IGRlbHRhIH0pfVxcblxcbmApKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKGVuY29kZXIuZW5jb2RlKGBkYXRhOiBbRE9ORV1cXG5cXG5gKSk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxuICAgICAgICAgICAgICAgICAgZW5jb2Rlci5lbmNvZGUoYGRhdGE6ICR7SlNPTi5zdHJpbmdpZnkoeyB0ZXh0OiByZXMudGV4dCB9KX1cXG5cXG5gKSxcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShlbmNvZGVyLmVuY29kZShgZGF0YTogW0RPTkVdXFxuXFxuYCkpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRyb2xsZXIuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gY2F0Y2gge1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUoZW5jb2Rlci5lbmNvZGUoYGV2ZW50OiBlcnJvclxcbmApKTtcbiAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKFxuICAgICAgICAgICAgICAgIGVuY29kZXIuZW5jb2RlKGBkYXRhOiAke0pTT04uc3RyaW5naWZ5KHsgZXJyb3I6IFwic3RyZWFtX2ZhaWxlZFwiIH0pfVxcblxcbmApLFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICBjb250cm9sbGVyLmNsb3NlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXcgUmVzcG9uc2UocnMsIHtcbiAgICAgICAgICBzdGF0dXM6IDIwMCxcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcInRleHQvZXZlbnQtc3RyZWFtOyBjaGFyc2V0PXV0Zi04XCIsXG4gICAgICAgICAgICBcImNhY2hlLWNvbnRyb2xcIjogXCJuby1jYWNoZSwgbm8tdHJhbnNmb3JtXCIsXG4gICAgICAgICAgICBjb25uZWN0aW9uOiBcImtlZXAtYWxpdmVcIixcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycjogYW55KSB7XG4gICAgICAgIGNvbnN0IHN0YXR1cyA9IG1hcEVycm9yVG9TdGF0dXMoZXJyKTtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShKU09OLnN0cmluZ2lmeSh7IGVycm9yOiBcImNoYXRfZmFpbGVkXCIgfSksIHtcbiAgICAgICAgICBzdGF0dXMsXG4gICAgICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCByZXMgPSBhd2FpdCBjaGF0KG1lc3NhZ2VzIGFzIENoYXRNZXNzYWdlW10sIHtcbiAgICAgIHByb3ZpZGVyLFxuICAgICAgbW9kZWwsXG4gICAgICBtYXhUb2tlbnM6IE1hdGgubWluKHR5cGVvZiBtYXhUb2tlbnMgPT09IFwibnVtYmVyXCIgPyBtYXhUb2tlbnMgOiAxMjgsIDEyOCksXG4gICAgICB0ZW1wZXJhdHVyZSxcbiAgICB9KTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgdGV4dDogcmVzLnRleHQsIHVzYWdlOiByZXMudXNhZ2UgfSksIHtcbiAgICAgIHN0YXR1czogMjAwLFxuICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgIGNvbnN0IHN0YXR1cyA9IG1hcEVycm9yVG9TdGF0dXMoZXJyKTtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKEpTT04uc3RyaW5naWZ5KHsgZXJyb3I6IFwiaW50ZXJuYWxfZXJyb3JcIiB9KSwge1xuICAgICAgc3RhdHVzLFxuICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1hcEVycm9yVG9TdGF0dXMoZXJyOiBhbnkpOiBudW1iZXIge1xuICBpZiAoZXJyIGluc3RhbmNlb2YgR3VhcmRyYWlsc0Vycm9yKSB7XG4gICAgaWYgKFN0cmluZyhlcnIubWVzc2FnZSkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInJhdGUgbGltaXRcIikpIHJldHVybiA0Mjk7XG4gICAgcmV0dXJuIDQwMDtcbiAgfVxuICBjb25zdCBzdGF0dXMgPSBlcnI/LnN0YXR1cyA/PyBlcnI/LnJlc3BvbnNlPy5zdGF0dXM7XG4gIGlmIChzdGF0dXMgPT09IDQyOSkgcmV0dXJuIDQyOTtcbiAgaWYgKHR5cGVvZiBzdGF0dXMgPT09IFwibnVtYmVyXCIgJiYgc3RhdHVzID49IDUwMCAmJiBzdGF0dXMgPD0gNTk5KSByZXR1cm4gNTAyO1xuICByZXR1cm4gNTAwO1xufVxuIl0sIm5hbWVzIjpbInoiLCJjaGF0IiwiR3VhcmRyYWlsc0Vycm9yIiwicmF0ZUxpbWl0IiwiYm9keVNjaGVtYSIsIm9iamVjdCIsInByb3ZpZGVyIiwiZW51bSIsIm1vZGVsIiwic3RyaW5nIiwibWluIiwibWVzc2FnZXMiLCJhcnJheSIsInJvbGUiLCJjb250ZW50IiwibWF4VG9rZW5zIiwibnVtYmVyIiwiaW50IiwicG9zaXRpdmUiLCJvcHRpb25hbCIsInRlbXBlcmF0dXJlIiwibWF4Iiwic3RyZWFtIiwiYm9vbGVhbiIsIlBPU1QiLCJyZXEiLCJqc29uIiwicGFyc2VkIiwic2FmZVBhcnNlIiwic3VjY2VzcyIsIlJlc3BvbnNlIiwiSlNPTiIsInN0cmluZ2lmeSIsImVycm9yIiwiZGV0YWlscyIsImZsYXR0ZW4iLCJzdGF0dXMiLCJoZWFkZXJzIiwiZGF0YSIsImlwIiwiZ2V0Iiwic3BsaXQiLCJ0cmltIiwiZSIsImlzUHJvbXB0QnJvQXNzaXN0IiwiY2FwUmF3IiwicHJvY2VzcyIsImVudiIsIlBST01QVEJST19BU1NJU1RfREFJTFlfQ0FQIiwiY2FwIiwiTWF0aCIsIk51bWJlciIsImRheUtleSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInNsaWNlIiwiZ2xvYmFsVGhpcyIsIl9fcGJfZGFpbHkiLCJNYXAiLCJrZXkiLCJjb3VudCIsInNldCIsInJlcyIsImVuY29kZXIiLCJUZXh0RW5jb2RlciIsInJhdyIsInJzIiwiUmVhZGFibGVTdHJlYW0iLCJzdGFydCIsImNvbnRyb2xsZXIiLCJTeW1ib2wiLCJhc3luY0l0ZXJhdG9yIiwiY2h1bmsiLCJkZWx0YSIsImNob2ljZXMiLCJlbnF1ZXVlIiwiZW5jb2RlIiwidGV4dCIsImNsb3NlIiwiY29ubmVjdGlvbiIsImVyciIsIm1hcEVycm9yVG9TdGF0dXMiLCJ1c2FnZSIsIlN0cmluZyIsIm1lc3NhZ2UiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwicmVzcG9uc2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/llm/chat/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   __clearConfigCache: () => (/* binding */ __clearConfigCache),\n/* harmony export */   getConfig: () => (/* binding */ getConfig)\n/* harmony export */ });\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/lib/index.mjs\");\n\nconst optionalNonEmpty = (schema)=>zod__WEBPACK_IMPORTED_MODULE_0__.z.preprocess((v)=>typeof v === \"string\" && v.trim().length === 0 ? undefined : v, schema.optional());\nconst envSchema = zod__WEBPACK_IMPORTED_MODULE_0__.z.object({\n    OPENAI_API_KEY: optionalNonEmpty(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().trim().min(1)),\n    OPENROUTER_API_KEY: optionalNonEmpty(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().trim().min(1)),\n    OPENROUTER_SITE: optionalNonEmpty(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().trim()),\n    ALLOWED_MODELS: optionalNonEmpty(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().trim()),\n    SUMMARIZER_MODEL: optionalNonEmpty(zod__WEBPACK_IMPORTED_MODULE_0__.z.string().trim()),\n    MAX_TOKENS_PER_CALL: zod__WEBPACK_IMPORTED_MODULE_0__.z.coerce.number().int().positive().default(512),\n    MAX_MESSAGES_PER_CONVO: zod__WEBPACK_IMPORTED_MODULE_0__.z.coerce.number().int().positive().default(25),\n    RATE_LIMIT_ENABLED: zod__WEBPACK_IMPORTED_MODULE_0__.z.union([\n        zod__WEBPACK_IMPORTED_MODULE_0__.z.string(),\n        zod__WEBPACK_IMPORTED_MODULE_0__.z.boolean()\n    ]).transform((v)=>typeof v === \"string\" ? v.toLowerCase() !== \"false\" : !!v).default(true),\n    RATE_LIMIT_RPM: zod__WEBPACK_IMPORTED_MODULE_0__.z.coerce.number().int().positive().default(60),\n    REQUEST_TIMEOUT_MS: zod__WEBPACK_IMPORTED_MODULE_0__.z.coerce.number().int().positive().default(60000),\n    MAX_USD_PER_CONVO: zod__WEBPACK_IMPORTED_MODULE_0__.z.coerce.number().nonnegative().optional()\n}).refine((v)=>Boolean(v.OPENAI_API_KEY || v.OPENROUTER_API_KEY), \"At least one provider key must be set: OPENAI_API_KEY or OPENROUTER_API_KEY\");\nlet cached;\nfunction getConfig() {\n    if (cached) return cached;\n    // In test env, allow missing provider keys by injecting a dummy key\n    const env = {\n        ...process.env\n    };\n    if (false) {}\n    const parsed = envSchema.parse(env);\n    cached = {\n        openaiApiKey: parsed.OPENAI_API_KEY || undefined,\n        openrouterApiKey: parsed.OPENROUTER_API_KEY || undefined,\n        openrouterSite: parsed.OPENROUTER_SITE || undefined,\n        allowedModels: parsed.ALLOWED_MODELS ? parsed.ALLOWED_MODELS.split(\",\").map((s)=>s.trim()).filter(Boolean) : [],\n        summarizerModel: parsed.SUMMARIZER_MODEL || undefined,\n        maxTokensPerCall: parsed.MAX_TOKENS_PER_CALL,\n        maxMessagesPerConversation: parsed.MAX_MESSAGES_PER_CONVO,\n        rateLimitEnabled: parsed.RATE_LIMIT_ENABLED,\n        rateLimitRpm: parsed.RATE_LIMIT_RPM,\n        requestTimeoutMs: parsed.REQUEST_TIMEOUT_MS,\n        maxUsdPerConversation: parsed.MAX_USD_PER_CONVO,\n        redisUrl: env.REDIS_URL || undefined\n    };\n    return cached;\n}\n// Test-only utility to reset cached config between test cases\nfunction __clearConfigCache() {\n    cached = undefined;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU9ULGtCQUFrQjtRQUMzQ3lCLHVCQUF1QmhCLE9BQU9SLGlCQUFpQjtRQUMvQ3lCLFVBQVVuQixJQUFJb0IsU0FBUyxJQUFJbkQ7SUFDN0I7SUFDQSxPQUFPNkI7QUFDVDtBQUVBLDhEQUE4RDtBQUN2RCxTQUFTdUI7SUFDZHZCLFNBQVM3QjtBQUNYIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbnQtd2Fycy13ZWIvLi9zcmMvbGliL2NvbmZpZy50cz9hM2VmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5cbmNvbnN0IG9wdGlvbmFsTm9uRW1wdHkgPSAoc2NoZW1hOiB6LlpvZFR5cGVBbnkpID0+XG4gIHoucHJlcHJvY2VzcyhcbiAgICAodikgPT4gKHR5cGVvZiB2ID09PSBcInN0cmluZ1wiICYmIHYudHJpbSgpLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IHYpLFxuICAgIHNjaGVtYS5vcHRpb25hbCgpLFxuICApO1xuXG5jb25zdCBlbnZTY2hlbWEgPSB6XG4gIC5vYmplY3Qoe1xuICAgIE9QRU5BSV9BUElfS0VZOiBvcHRpb25hbE5vbkVtcHR5KHouc3RyaW5nKCkudHJpbSgpLm1pbigxKSksXG4gICAgT1BFTlJPVVRFUl9BUElfS0VZOiBvcHRpb25hbE5vbkVtcHR5KHouc3RyaW5nKCkudHJpbSgpLm1pbigxKSksXG4gICAgT1BFTlJPVVRFUl9TSVRFOiBvcHRpb25hbE5vbkVtcHR5KHouc3RyaW5nKCkudHJpbSgpKSxcbiAgICBBTExPV0VEX01PREVMUzogb3B0aW9uYWxOb25FbXB0eSh6LnN0cmluZygpLnRyaW0oKSksXG4gICAgU1VNTUFSSVpFUl9NT0RFTDogb3B0aW9uYWxOb25FbXB0eSh6LnN0cmluZygpLnRyaW0oKSksXG4gICAgTUFYX1RPS0VOU19QRVJfQ0FMTDogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDUxMiksXG4gICAgTUFYX01FU1NBR0VTX1BFUl9DT05WTzogei5jb2VyY2UubnVtYmVyKCkuaW50KCkucG9zaXRpdmUoKS5kZWZhdWx0KDI1KSxcbiAgICBSQVRFX0xJTUlUX0VOQUJMRUQ6IHpcbiAgICAgIC51bmlvbihbei5zdHJpbmcoKSwgei5ib29sZWFuKCldKVxuICAgICAgLnRyYW5zZm9ybSgodikgPT4gKHR5cGVvZiB2ID09PSBcInN0cmluZ1wiID8gdi50b0xvd2VyQ2FzZSgpICE9PSBcImZhbHNlXCIgOiAhIXYpKVxuICAgICAgLmRlZmF1bHQodHJ1ZSksXG4gICAgUkFURV9MSU1JVF9SUE06IHouY29lcmNlLm51bWJlcigpLmludCgpLnBvc2l0aXZlKCkuZGVmYXVsdCg2MCksXG4gICAgUkVRVUVTVF9USU1FT1VUX01TOiB6LmNvZXJjZS5udW1iZXIoKS5pbnQoKS5wb3NpdGl2ZSgpLmRlZmF1bHQoNjAwMDApLFxuICAgIE1BWF9VU0RfUEVSX0NPTlZPOiB6LmNvZXJjZS5udW1iZXIoKS5ub25uZWdhdGl2ZSgpLm9wdGlvbmFsKCksXG4gIH0pXG4gIC5yZWZpbmUoXG4gICAgKHYpID0+IEJvb2xlYW4odi5PUEVOQUlfQVBJX0tFWSB8fCB2Lk9QRU5ST1VURVJfQVBJX0tFWSksXG4gICAgXCJBdCBsZWFzdCBvbmUgcHJvdmlkZXIga2V5IG11c3QgYmUgc2V0OiBPUEVOQUlfQVBJX0tFWSBvciBPUEVOUk9VVEVSX0FQSV9LRVlcIixcbiAgKTtcblxuLy8gTm90ZTogV2UgYXZvaWQgbWVyZ2luZyBkdWUgdG8gWm9kIGVmZmVjdHMgdHlwaW5nOyByZWFkIFJFRElTX1VSTCBkaXJlY3RseSBmcm9tIHByb2Nlc3MuZW52XG5cbmV4cG9ydCB0eXBlIEFwcENvbmZpZyA9IHtcbiAgb3BlbmFpQXBpS2V5Pzogc3RyaW5nO1xuICBvcGVucm91dGVyQXBpS2V5Pzogc3RyaW5nO1xuICBvcGVucm91dGVyU2l0ZT86IHN0cmluZztcbiAgYWxsb3dlZE1vZGVsczogc3RyaW5nW107XG4gIHN1bW1hcml6ZXJNb2RlbD86IHN0cmluZztcbiAgbWF4VG9rZW5zUGVyQ2FsbDogbnVtYmVyO1xuICBtYXhNZXNzYWdlc1BlckNvbnZlcnNhdGlvbjogbnVtYmVyO1xuICByYXRlTGltaXRFbmFibGVkOiBib29sZWFuO1xuICByYXRlTGltaXRScG06IG51bWJlcjtcbiAgcmVxdWVzdFRpbWVvdXRNczogbnVtYmVyO1xuICBtYXhVc2RQZXJDb252ZXJzYXRpb24/OiBudW1iZXI7XG4gIHJlZGlzVXJsPzogc3RyaW5nO1xufTtcblxubGV0IGNhY2hlZDogQXBwQ29uZmlnIHwgdW5kZWZpbmVkO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q29uZmlnKCk6IEFwcENvbmZpZyB7XG4gIGlmIChjYWNoZWQpIHJldHVybiBjYWNoZWQ7XG4gIC8vIEluIHRlc3QgZW52LCBhbGxvdyBtaXNzaW5nIHByb3ZpZGVyIGtleXMgYnkgaW5qZWN0aW5nIGEgZHVtbXkga2V5XG4gIGNvbnN0IGVudiA9IHsgLi4ucHJvY2Vzcy5lbnYgfSBhcyBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCB1bmRlZmluZWQ+O1xuICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09IFwidGVzdFwiICYmICFlbnYuT1BFTkFJX0FQSV9LRVkgJiYgIWVudi5PUEVOUk9VVEVSX0FQSV9LRVkpIHtcbiAgICBlbnYuT1BFTkFJX0FQSV9LRVkgPSBcInRlc3Qta2V5XCI7XG4gIH1cbiAgY29uc3QgcGFyc2VkID0gZW52U2NoZW1hLnBhcnNlKGVudik7XG4gIGNhY2hlZCA9IHtcbiAgICBvcGVuYWlBcGlLZXk6IHBhcnNlZC5PUEVOQUlfQVBJX0tFWSB8fCB1bmRlZmluZWQsXG4gICAgb3BlbnJvdXRlckFwaUtleTogcGFyc2VkLk9QRU5ST1VURVJfQVBJX0tFWSB8fCB1bmRlZmluZWQsXG4gICAgb3BlbnJvdXRlclNpdGU6IHBhcnNlZC5PUEVOUk9VVEVSX1NJVEUgfHwgdW5kZWZpbmVkLFxuICAgIGFsbG93ZWRNb2RlbHM6IHBhcnNlZC5BTExPV0VEX01PREVMU1xuICAgICAgPyBwYXJzZWQuQUxMT1dFRF9NT0RFTFMuc3BsaXQoXCIsXCIpXG4gICAgICAgICAgLm1hcCgoczogc3RyaW5nKSA9PiBzLnRyaW0oKSlcbiAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICA6IFtdLFxuICAgIHN1bW1hcml6ZXJNb2RlbDogcGFyc2VkLlNVTU1BUklaRVJfTU9ERUwgfHwgdW5kZWZpbmVkLFxuICAgIG1heFRva2Vuc1BlckNhbGw6IHBhcnNlZC5NQVhfVE9LRU5TX1BFUl9DQUxMLFxuICAgIG1heE1lc3NhZ2VzUGVyQ29udmVyc2F0aW9uOiBwYXJzZWQuTUFYX01FU1NBR0VTX1BFUl9DT05WTyxcbiAgICByYXRlTGltaXRFbmFibGVkOiBwYXJzZWQuUkFURV9MSU1JVF9FTkFCTEVELFxuICAgIHJhdGVMaW1pdFJwbTogcGFyc2VkLlJBVEVfTElNSVRfUlBNLFxuICAgIHJlcXVlc3RUaW1lb3V0TXM6IHBhcnNlZC5SRVFVRVNUX1RJTUVPVVRfTVMsXG4gICAgbWF4VXNkUGVyQ29udmVyc2F0aW9uOiBwYXJzZWQuTUFYX1VTRF9QRVJfQ09OVk8sXG4gICAgcmVkaXNVcmw6IGVudi5SRURJU19VUkwgfHwgdW5kZWZpbmVkLFxuICB9O1xuICByZXR1cm4gY2FjaGVkO1xufVxuXG4vLyBUZXN0LW9ubHkgdXRpbGl0eSB0byByZXNldCBjYWNoZWQgY29uZmlnIGJldHdlZW4gdGVzdCBjYXNlc1xuZXhwb3J0IGZ1bmN0aW9uIF9fY2xlYXJDb25maWdDYWNoZSgpOiB2b2lkIHtcbiAgY2FjaGVkID0gdW5kZWZpbmVkO1xufVxuIl0sIm5hbWVzIjpbInoiLCJvcHRpb25hbE5vbkVtcHR5Iiwic2NoZW1hIiwicHJlcHJvY2VzcyIsInYiLCJ0cmltIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwib3B0aW9uYWwiLCJlbnZTY2hlbWEiLCJvYmplY3QiLCJPUEVOQUlfQVBJX0tFWSIsInN0cmluZyIsIm1pbiIsIk9QRU5ST1VURVJfQVBJX0tFWSIsIk9QRU5ST1VURVJfU0lURSIsIkFMTE9XRURfTU9ERUxTIiwiU1VNTUFSSVpFUl9NT0RFTCIsIk1BWF9UT0tFTlNfUEVSX0NBTEwiLCJjb2VyY2UiLCJudW1iZXIiLCJpbnQiLCJwb3NpdGl2ZSIsImRlZmF1bHQiLCJNQVhfTUVTU0FHRVNfUEVSX0NPTlZPIiwiUkFURV9MSU1JVF9FTkFCTEVEIiwidW5pb24iLCJib29sZWFuIiwidHJhbnNmb3JtIiwidG9Mb3dlckNhc2UiLCJSQVRFX0xJTUlUX1JQTSIsIlJFUVVFU1RfVElNRU9VVF9NUyIsIk1BWF9VU0RfUEVSX0NPTlZPIiwibm9ubmVnYXRpdmUiLCJyZWZpbmUiLCJCb29sZWFuIiwiY2FjaGVkIiwiZ2V0Q29uZmlnIiwiZW52IiwicHJvY2VzcyIsInBhcnNlZCIsInBhcnNlIiwib3BlbmFpQXBpS2V5Iiwib3BlbnJvdXRlckFwaUtleSIsIm9wZW5yb3V0ZXJTaXRlIiwiYWxsb3dlZE1vZGVscyIsInNwbGl0IiwibWFwIiwicyIsImZpbHRlciIsInN1bW1hcml6ZXJNb2RlbCIsIm1heFRva2Vuc1BlckNhbGwiLCJtYXhNZXNzYWdlc1BlckNvbnZlcnNhdGlvbiIsInJhdGVMaW1pdEVuYWJsZWQiLCJyYXRlTGltaXRScG0iLCJyZXF1ZXN0VGltZW91dE1zIiwibWF4VXNkUGVyQ29udmVyc2F0aW9uIiwicmVkaXNVcmwiLCJSRURJU19VUkwiLCJfX2NsZWFyQ29uZmlnQ2FjaGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/llm/guards.ts":
/*!*******************************!*\
  !*** ./src/lib/llm/guards.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GuardrailsError: () => (/* binding */ GuardrailsError),\n/* harmony export */   computeBackoffDelayMs: () => (/* binding */ computeBackoffDelayMs),\n/* harmony export */   enforceCaps: () => (/* binding */ enforceCaps),\n/* harmony export */   getAllowedModels: () => (/* binding */ getAllowedModels),\n/* harmony export */   getMaxMessagesPerConversation: () => (/* binding */ getMaxMessagesPerConversation),\n/* harmony export */   getMaxTokensPerCall: () => (/* binding */ getMaxTokensPerCall),\n/* harmony export */   rateLimit: () => (/* binding */ rateLimit),\n/* harmony export */   sleep: () => (/* binding */ sleep)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\nfunction getAllowedModels() {\n    const cfg = (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.getConfig)();\n    return new Set(cfg.allowedModels);\n}\nfunction getMaxTokensPerCall() {\n    return (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.getConfig)().maxTokensPerCall;\n}\nfunction getMaxMessagesPerConversation() {\n    return (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.getConfig)().maxMessagesPerConversation;\n}\nclass GuardrailsError extends Error {\n    constructor(message){\n        super(message);\n        this.name = \"GuardrailsError\";\n    }\n}\nfunction enforceCaps(args) {\n    const maxTokens = getMaxTokensPerCall();\n    if ((args.requestedMaxTokens ?? maxTokens) > maxTokens) {\n        throw new GuardrailsError(`maxTokens exceeds cap (${args.requestedMaxTokens} > ${maxTokens})`);\n    }\n    const maxMsgs = getMaxMessagesPerConversation();\n    if (args.messageCount > maxMsgs) {\n        throw new GuardrailsError(`message count exceeds cap (${args.messageCount} > ${maxMsgs})`);\n    }\n    const allowed = getAllowedModels();\n    if (allowed.size > 0 && !allowed.has(args.model)) {\n        throw new GuardrailsError(`model not allowed: ${args.model}`);\n    }\n}\nconst limiterStore = new Map();\nfunction rateLimit(key) {\n    const cfg = (0,_lib_config__WEBPACK_IMPORTED_MODULE_0__.getConfig)();\n    if (!cfg.rateLimitEnabled) return;\n    const maxPerWindow = cfg.rateLimitRpm;\n    const now = Date.now();\n    const windowMs = 60000;\n    const w = limiterStore.get(key);\n    if (!w || now - w.windowStartMs >= windowMs) {\n        limiterStore.set(key, {\n            count: 1,\n            windowStartMs: now\n        });\n        return;\n    }\n    if (w.count >= maxPerWindow) {\n        throw new GuardrailsError(\"rate limit exceeded\");\n    }\n    w.count += 1;\n}\nasync function sleep(ms) {\n    await new Promise((res)=>setTimeout(res, ms));\n}\nfunction computeBackoffDelayMs(attempt) {\n    // attempt: 0,1,2 -> 250ms, 750ms, 1250ms with jitter\n    const base = 250 + attempt * 500;\n    const jitter = Math.floor(Math.random() * 100);\n    return base + jitter;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2xsbS9ndWFyZHMudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQXlDO0FBRWxDLFNBQVNDO0lBQ2QsTUFBTUMsTUFBTUYsc0RBQVNBO0lBQ3JCLE9BQU8sSUFBSUcsSUFBSUQsSUFBSUUsYUFBYTtBQUNsQztBQUVPLFNBQVNDO0lBQ2QsT0FBT0wsc0RBQVNBLEdBQUdNLGdCQUFnQjtBQUNyQztBQUVPLFNBQVNDO0lBQ2QsT0FBT1Asc0RBQVNBLEdBQUdRLDBCQUEwQjtBQUMvQztBQUVPLE1BQU1DLHdCQUF3QkM7SUFDbkNDLFlBQVlDLE9BQWUsQ0FBRTtRQUMzQixLQUFLLENBQUNBO1FBQ04sSUFBSSxDQUFDQyxJQUFJLEdBQUc7SUFDZDtBQUNGO0FBRU8sU0FBU0MsWUFBWUMsSUFJM0I7SUFDQyxNQUFNQyxZQUFZWDtJQUNsQixJQUFJLENBQUNVLEtBQUtFLGtCQUFrQixJQUFJRCxTQUFRLElBQUtBLFdBQVc7UUFDdEQsTUFBTSxJQUFJUCxnQkFBZ0IsQ0FBQyx1QkFBdUIsRUFBRU0sS0FBS0Usa0JBQWtCLENBQUMsR0FBRyxFQUFFRCxVQUFVLENBQUMsQ0FBQztJQUMvRjtJQUNBLE1BQU1FLFVBQVVYO0lBQ2hCLElBQUlRLEtBQUtJLFlBQVksR0FBR0QsU0FBUztRQUMvQixNQUFNLElBQUlULGdCQUFnQixDQUFDLDJCQUEyQixFQUFFTSxLQUFLSSxZQUFZLENBQUMsR0FBRyxFQUFFRCxRQUFRLENBQUMsQ0FBQztJQUMzRjtJQUNBLE1BQU1FLFVBQVVuQjtJQUNoQixJQUFJbUIsUUFBUUMsSUFBSSxHQUFHLEtBQUssQ0FBQ0QsUUFBUUUsR0FBRyxDQUFDUCxLQUFLUSxLQUFLLEdBQUc7UUFDaEQsTUFBTSxJQUFJZCxnQkFBZ0IsQ0FBQyxtQkFBbUIsRUFBRU0sS0FBS1EsS0FBSyxDQUFDLENBQUM7SUFDOUQ7QUFDRjtBQUdBLE1BQU1DLGVBQW9DLElBQUlDO0FBRXZDLFNBQVNDLFVBQVVDLEdBQVc7SUFDbkMsTUFBTXpCLE1BQU1GLHNEQUFTQTtJQUNyQixJQUFJLENBQUNFLElBQUkwQixnQkFBZ0IsRUFBRTtJQUMzQixNQUFNQyxlQUFlM0IsSUFBSTRCLFlBQVk7SUFDckMsTUFBTUMsTUFBTUMsS0FBS0QsR0FBRztJQUNwQixNQUFNRSxXQUFXO0lBQ2pCLE1BQU1DLElBQUlWLGFBQWFXLEdBQUcsQ0FBQ1I7SUFDM0IsSUFBSSxDQUFDTyxLQUFLSCxNQUFNRyxFQUFFRSxhQUFhLElBQUlILFVBQVU7UUFDM0NULGFBQWFhLEdBQUcsQ0FBQ1YsS0FBSztZQUFFVyxPQUFPO1lBQUdGLGVBQWVMO1FBQUk7UUFDckQ7SUFDRjtJQUNBLElBQUlHLEVBQUVJLEtBQUssSUFBSVQsY0FBYztRQUMzQixNQUFNLElBQUlwQixnQkFBZ0I7SUFDNUI7SUFDQXlCLEVBQUVJLEtBQUssSUFBSTtBQUNiO0FBRU8sZUFBZUMsTUFBTUMsRUFBVTtJQUNwQyxNQUFNLElBQUlDLFFBQVEsQ0FBQ0MsTUFBUUMsV0FBV0QsS0FBS0Y7QUFDN0M7QUFFTyxTQUFTSSxzQkFBc0JDLE9BQWU7SUFDbkQscURBQXFEO0lBQ3JELE1BQU1DLE9BQU8sTUFBTUQsVUFBVTtJQUM3QixNQUFNRSxTQUFTQyxLQUFLQyxLQUFLLENBQUNELEtBQUtFLE1BQU0sS0FBSztJQUMxQyxPQUFPSixPQUFPQztBQUNoQiIsInNvdXJjZXMiOlsid2VicGFjazovL2FnZW50LXdhcnMtd2ViLy4vc3JjL2xpYi9sbG0vZ3VhcmRzLnRzP2I5NDUiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZ2V0Q29uZmlnIH0gZnJvbSBcIkAvbGliL2NvbmZpZ1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWxsb3dlZE1vZGVscygpOiBTZXQ8c3RyaW5nPiB7XG4gIGNvbnN0IGNmZyA9IGdldENvbmZpZygpO1xuICByZXR1cm4gbmV3IFNldChjZmcuYWxsb3dlZE1vZGVscyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRNYXhUb2tlbnNQZXJDYWxsKCk6IG51bWJlciB7XG4gIHJldHVybiBnZXRDb25maWcoKS5tYXhUb2tlbnNQZXJDYWxsO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWF4TWVzc2FnZXNQZXJDb252ZXJzYXRpb24oKTogbnVtYmVyIHtcbiAgcmV0dXJuIGdldENvbmZpZygpLm1heE1lc3NhZ2VzUGVyQ29udmVyc2F0aW9uO1xufVxuXG5leHBvcnQgY2xhc3MgR3VhcmRyYWlsc0Vycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcihtZXNzYWdlOiBzdHJpbmcpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkd1YXJkcmFpbHNFcnJvclwiO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbmZvcmNlQ2FwcyhhcmdzOiB7XG4gIHJlcXVlc3RlZE1heFRva2VuczogbnVtYmVyIHwgdW5kZWZpbmVkO1xuICBtZXNzYWdlQ291bnQ6IG51bWJlcjtcbiAgbW9kZWw6IHN0cmluZztcbn0pOiB2b2lkIHtcbiAgY29uc3QgbWF4VG9rZW5zID0gZ2V0TWF4VG9rZW5zUGVyQ2FsbCgpO1xuICBpZiAoKGFyZ3MucmVxdWVzdGVkTWF4VG9rZW5zID8/IG1heFRva2VucykgPiBtYXhUb2tlbnMpIHtcbiAgICB0aHJvdyBuZXcgR3VhcmRyYWlsc0Vycm9yKGBtYXhUb2tlbnMgZXhjZWVkcyBjYXAgKCR7YXJncy5yZXF1ZXN0ZWRNYXhUb2tlbnN9ID4gJHttYXhUb2tlbnN9KWApO1xuICB9XG4gIGNvbnN0IG1heE1zZ3MgPSBnZXRNYXhNZXNzYWdlc1BlckNvbnZlcnNhdGlvbigpO1xuICBpZiAoYXJncy5tZXNzYWdlQ291bnQgPiBtYXhNc2dzKSB7XG4gICAgdGhyb3cgbmV3IEd1YXJkcmFpbHNFcnJvcihgbWVzc2FnZSBjb3VudCBleGNlZWRzIGNhcCAoJHthcmdzLm1lc3NhZ2VDb3VudH0gPiAke21heE1zZ3N9KWApO1xuICB9XG4gIGNvbnN0IGFsbG93ZWQgPSBnZXRBbGxvd2VkTW9kZWxzKCk7XG4gIGlmIChhbGxvd2VkLnNpemUgPiAwICYmICFhbGxvd2VkLmhhcyhhcmdzLm1vZGVsKSkge1xuICAgIHRocm93IG5ldyBHdWFyZHJhaWxzRXJyb3IoYG1vZGVsIG5vdCBhbGxvd2VkOiAke2FyZ3MubW9kZWx9YCk7XG4gIH1cbn1cblxudHlwZSBXaW5kb3cgPSB7IGNvdW50OiBudW1iZXI7IHdpbmRvd1N0YXJ0TXM6IG51bWJlciB9O1xuY29uc3QgbGltaXRlclN0b3JlOiBNYXA8c3RyaW5nLCBXaW5kb3c+ID0gbmV3IE1hcCgpO1xuXG5leHBvcnQgZnVuY3Rpb24gcmF0ZUxpbWl0KGtleTogc3RyaW5nKTogdm9pZCB7XG4gIGNvbnN0IGNmZyA9IGdldENvbmZpZygpO1xuICBpZiAoIWNmZy5yYXRlTGltaXRFbmFibGVkKSByZXR1cm47XG4gIGNvbnN0IG1heFBlcldpbmRvdyA9IGNmZy5yYXRlTGltaXRScG07XG4gIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gIGNvbnN0IHdpbmRvd01zID0gNjBfMDAwO1xuICBjb25zdCB3ID0gbGltaXRlclN0b3JlLmdldChrZXkpO1xuICBpZiAoIXcgfHwgbm93IC0gdy53aW5kb3dTdGFydE1zID49IHdpbmRvd01zKSB7XG4gICAgbGltaXRlclN0b3JlLnNldChrZXksIHsgY291bnQ6IDEsIHdpbmRvd1N0YXJ0TXM6IG5vdyB9KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKHcuY291bnQgPj0gbWF4UGVyV2luZG93KSB7XG4gICAgdGhyb3cgbmV3IEd1YXJkcmFpbHNFcnJvcihcInJhdGUgbGltaXQgZXhjZWVkZWRcIik7XG4gIH1cbiAgdy5jb3VudCArPSAxO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2xlZXAobXM6IG51bWJlcik6IFByb21pc2U8dm9pZD4ge1xuICBhd2FpdCBuZXcgUHJvbWlzZSgocmVzKSA9PiBzZXRUaW1lb3V0KHJlcywgbXMpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbXB1dGVCYWNrb2ZmRGVsYXlNcyhhdHRlbXB0OiBudW1iZXIpOiBudW1iZXIge1xuICAvLyBhdHRlbXB0OiAwLDEsMiAtPiAyNTBtcywgNzUwbXMsIDEyNTBtcyB3aXRoIGppdHRlclxuICBjb25zdCBiYXNlID0gMjUwICsgYXR0ZW1wdCAqIDUwMDtcbiAgY29uc3Qgaml0dGVyID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTAwKTtcbiAgcmV0dXJuIGJhc2UgKyBqaXR0ZXI7XG59XG4iXSwibmFtZXMiOlsiZ2V0Q29uZmlnIiwiZ2V0QWxsb3dlZE1vZGVscyIsImNmZyIsIlNldCIsImFsbG93ZWRNb2RlbHMiLCJnZXRNYXhUb2tlbnNQZXJDYWxsIiwibWF4VG9rZW5zUGVyQ2FsbCIsImdldE1heE1lc3NhZ2VzUGVyQ29udmVyc2F0aW9uIiwibWF4TWVzc2FnZXNQZXJDb252ZXJzYXRpb24iLCJHdWFyZHJhaWxzRXJyb3IiLCJFcnJvciIsImNvbnN0cnVjdG9yIiwibWVzc2FnZSIsIm5hbWUiLCJlbmZvcmNlQ2FwcyIsImFyZ3MiLCJtYXhUb2tlbnMiLCJyZXF1ZXN0ZWRNYXhUb2tlbnMiLCJtYXhNc2dzIiwibWVzc2FnZUNvdW50IiwiYWxsb3dlZCIsInNpemUiLCJoYXMiLCJtb2RlbCIsImxpbWl0ZXJTdG9yZSIsIk1hcCIsInJhdGVMaW1pdCIsImtleSIsInJhdGVMaW1pdEVuYWJsZWQiLCJtYXhQZXJXaW5kb3ciLCJyYXRlTGltaXRScG0iLCJub3ciLCJEYXRlIiwid2luZG93TXMiLCJ3IiwiZ2V0Iiwid2luZG93U3RhcnRNcyIsInNldCIsImNvdW50Iiwic2xlZXAiLCJtcyIsIlByb21pc2UiLCJyZXMiLCJzZXRUaW1lb3V0IiwiY29tcHV0ZUJhY2tvZmZEZWxheU1zIiwiYXR0ZW1wdCIsImJhc2UiLCJqaXR0ZXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/llm/guards.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/llm/provider.ts":
/*!*********************************!*\
  !*** ./src/lib/llm/provider.ts ***!
  \*********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   chat: () => (/* binding */ chat)\n/* harmony export */ });\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _lib_llm_guards__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/llm/guards */ \"(rsc)/./src/lib/llm/guards.ts\");\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\n\n\nasync function chat(messages, opts) {\n    if (process.env.E2E_MODE === \"1\") {\n        // Deterministic stub for E2E: echo the last user content\n        const lastUser = [\n            ...messages\n        ].reverse().find((m)=>m.role === \"user\");\n        const text = lastUser?.content ? `E2E: ${lastUser.content}` : \"E2E: ok\";\n        return {\n            text,\n            usage: {\n                inputTokens: 10,\n                outputTokens: 20\n            },\n            raw: {}\n        };\n    }\n    // Guardrails\n    (0,_lib_llm_guards__WEBPACK_IMPORTED_MODULE_0__.enforceCaps)({\n        requestedMaxTokens: opts.maxTokens,\n        messageCount: messages.length,\n        model: opts.model\n    });\n    (0,_lib_llm_guards__WEBPACK_IMPORTED_MODULE_0__.rateLimit)(`${opts.provider}:${opts.model}`);\n    const cfg = (0,_lib_config__WEBPACK_IMPORTED_MODULE_1__.getConfig)();\n    const isOpenRouter = opts.provider === \"openrouter\";\n    const client = new openai__WEBPACK_IMPORTED_MODULE_2__[\"default\"]({\n        apiKey: isOpenRouter ? cfg.openrouterApiKey : cfg.openaiApiKey,\n        baseURL: isOpenRouter ? \"https://openrouter.ai/api/v1\" : undefined\n    });\n    const headers = isOpenRouter ? {\n        \"HTTP-Referer\": cfg.openrouterSite || \"\",\n        \"X-Title\": \"Agent Wars\"\n    } : undefined;\n    if (opts.stream) {\n        // Minimal streaming assembly (iterator mode)\n        const stream = await client.chat.completions.create({\n            model: opts.model,\n            messages,\n            max_tokens: opts.maxTokens ?? 512,\n            temperature: opts.temperature ?? 0.2,\n            stop: opts.stop,\n            stream: true,\n            extra_headers: headers\n        });\n        let text = \"\";\n        // openai v4 streams expose an async iterator via .[Symbol.asyncIterator]\n        // Cast to any to iterate chunks\n        for await (const chunk of stream){\n            const delta = chunk?.choices?.[0]?.delta?.content;\n            if (delta) text += delta;\n        }\n        return {\n            text,\n            raw: stream\n        };\n    }\n    let lastErr;\n    for(let attempt = 0; attempt < 3; attempt++){\n        try {\n            const resp = await client.chat.completions.create({\n                model: opts.model,\n                messages,\n                max_tokens: opts.maxTokens ?? 512,\n                temperature: opts.temperature ?? 0.2,\n                stop: opts.stop,\n                extra_headers: headers\n            });\n            const text = resp.choices?.[0]?.message?.content ?? \"\";\n            const usage = resp.usage ? {\n                inputTokens: resp.usage.prompt_tokens ?? 0,\n                outputTokens: resp.usage.completion_tokens ?? 0\n            } : undefined;\n            return {\n                text,\n                usage,\n                raw: resp\n            };\n        } catch (err) {\n            lastErr = err;\n            const status = err?.status ?? err?.response?.status;\n            if (attempt < 2 && (status === 429 || status >= 500 && status <= 599)) {\n                await (0,_lib_llm_guards__WEBPACK_IMPORTED_MODULE_0__.sleep)((0,_lib_llm_guards__WEBPACK_IMPORTED_MODULE_0__.computeBackoffDelayMs)(attempt));\n                continue;\n            }\n            throw err;\n        }\n    }\n    throw lastErr;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFFSixPQUFPO2dCQUFFbkI7Z0JBQU1FO2dCQUFPRyxLQUFLNkI7WUFBSztRQUNsQyxFQUFFLE9BQU9JLEtBQVU7WUFDakJOLFVBQVVNO1lBQ1YsTUFBTUMsU0FBU0QsS0FBS0MsVUFBVUQsS0FBS0UsVUFBVUQ7WUFDN0MsSUFBSU4sVUFBVSxLQUFNTSxDQUFBQSxXQUFXLE9BQVFBLFVBQVUsT0FBT0EsVUFBVSxHQUFHLEdBQUk7Z0JBQ3ZFLE1BQU1wRCxzREFBS0EsQ0FBQ0Qsc0VBQXFCQSxDQUFDK0M7Z0JBQ2xDO1lBQ0Y7WUFDQSxNQUFNSztRQUNSO0lBQ0Y7SUFDQSxNQUFNTjtBQUNSIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vYWdlbnQtd2Fycy13ZWIvLi9zcmMvbGliL2xsbS9wcm92aWRlci50cz82ZDYwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBPcGVuQUkgZnJvbSBcIm9wZW5haVwiO1xuaW1wb3J0IHsgZW5mb3JjZUNhcHMsIHJhdGVMaW1pdCwgY29tcHV0ZUJhY2tvZmZEZWxheU1zLCBzbGVlcCB9IGZyb20gXCJAL2xpYi9sbG0vZ3VhcmRzXCI7XG5pbXBvcnQgeyBnZXRDb25maWcgfSBmcm9tIFwiQC9saWIvY29uZmlnXCI7XG5cbmV4cG9ydCB0eXBlIENoYXRNZXNzYWdlID0ge1xuICByb2xlOiBcInN5c3RlbVwiIHwgXCJ1c2VyXCIgfCBcImFzc2lzdGFudFwiIHwgXCJ0b29sXCI7XG4gIGNvbnRlbnQ6IHN0cmluZztcbn07XG5cbmV4cG9ydCB0eXBlIENoYXRPcHRpb25zID0ge1xuICBwcm92aWRlcjogXCJvcGVuYWlcIiB8IFwib3BlbnJvdXRlclwiO1xuICBtb2RlbDogc3RyaW5nO1xuICBtYXhUb2tlbnM/OiBudW1iZXI7XG4gIHRlbXBlcmF0dXJlPzogbnVtYmVyO1xuICBzdG9wPzogc3RyaW5nW107XG4gIHN0cmVhbT86IGJvb2xlYW47XG59O1xuXG5leHBvcnQgdHlwZSBDaGF0VXNhZ2UgPSB7IGlucHV0VG9rZW5zOiBudW1iZXI7IG91dHB1dFRva2VuczogbnVtYmVyIH07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjaGF0KFxuICBtZXNzYWdlczogQ2hhdE1lc3NhZ2VbXSxcbiAgb3B0czogQ2hhdE9wdGlvbnMsXG4pOiBQcm9taXNlPHsgdGV4dDogc3RyaW5nOyB1c2FnZT86IENoYXRVc2FnZTsgcmF3OiB1bmtub3duIH0+IHtcbiAgaWYgKHByb2Nlc3MuZW52LkUyRV9NT0RFID09PSBcIjFcIikge1xuICAgIC8vIERldGVybWluaXN0aWMgc3R1YiBmb3IgRTJFOiBlY2hvIHRoZSBsYXN0IHVzZXIgY29udGVudFxuICAgIGNvbnN0IGxhc3RVc2VyID0gWy4uLm1lc3NhZ2VzXS5yZXZlcnNlKCkuZmluZCgobSkgPT4gbS5yb2xlID09PSBcInVzZXJcIik7XG4gICAgY29uc3QgdGV4dCA9IGxhc3RVc2VyPy5jb250ZW50ID8gYEUyRTogJHtsYXN0VXNlci5jb250ZW50fWAgOiBcIkUyRTogb2tcIjtcbiAgICByZXR1cm4geyB0ZXh0LCB1c2FnZTogeyBpbnB1dFRva2VuczogMTAsIG91dHB1dFRva2VuczogMjAgfSwgcmF3OiB7fSB9O1xuICB9XG4gIC8vIEd1YXJkcmFpbHNcbiAgZW5mb3JjZUNhcHMoe1xuICAgIHJlcXVlc3RlZE1heFRva2Vuczogb3B0cy5tYXhUb2tlbnMsXG4gICAgbWVzc2FnZUNvdW50OiBtZXNzYWdlcy5sZW5ndGgsXG4gICAgbW9kZWw6IG9wdHMubW9kZWwsXG4gIH0pO1xuICByYXRlTGltaXQoYCR7b3B0cy5wcm92aWRlcn06JHtvcHRzLm1vZGVsfWApO1xuICBjb25zdCBjZmcgPSBnZXRDb25maWcoKTtcbiAgY29uc3QgaXNPcGVuUm91dGVyID0gb3B0cy5wcm92aWRlciA9PT0gXCJvcGVucm91dGVyXCI7XG5cbiAgY29uc3QgY2xpZW50ID0gbmV3IE9wZW5BSSh7XG4gICAgYXBpS2V5OiBpc09wZW5Sb3V0ZXIgPyBjZmcub3BlbnJvdXRlckFwaUtleSA6IGNmZy5vcGVuYWlBcGlLZXksXG4gICAgYmFzZVVSTDogaXNPcGVuUm91dGVyID8gXCJodHRwczovL29wZW5yb3V0ZXIuYWkvYXBpL3YxXCIgOiB1bmRlZmluZWQsXG4gIH0pO1xuXG4gIGNvbnN0IGhlYWRlcnMgPSBpc09wZW5Sb3V0ZXJcbiAgICA/IHtcbiAgICAgICAgXCJIVFRQLVJlZmVyZXJcIjogY2ZnLm9wZW5yb3V0ZXJTaXRlIHx8IFwiXCIsXG4gICAgICAgIFwiWC1UaXRsZVwiOiBcIkFnZW50IFdhcnNcIixcbiAgICAgIH1cbiAgICA6IHVuZGVmaW5lZDtcblxuICBpZiAob3B0cy5zdHJlYW0pIHtcbiAgICAvLyBNaW5pbWFsIHN0cmVhbWluZyBhc3NlbWJseSAoaXRlcmF0b3IgbW9kZSlcbiAgICBjb25zdCBzdHJlYW0gPSBhd2FpdCBjbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgbW9kZWw6IG9wdHMubW9kZWwsXG4gICAgICBtZXNzYWdlcyxcbiAgICAgIG1heF90b2tlbnM6IG9wdHMubWF4VG9rZW5zID8/IDUxMixcbiAgICAgIHRlbXBlcmF0dXJlOiBvcHRzLnRlbXBlcmF0dXJlID8/IDAuMixcbiAgICAgIHN0b3A6IG9wdHMuc3RvcCxcbiAgICAgIHN0cmVhbTogdHJ1ZSxcbiAgICAgIGV4dHJhX2hlYWRlcnM6IGhlYWRlcnMgYXMgYW55LFxuICAgIH0gYXMgYW55KTtcblxuICAgIGxldCB0ZXh0ID0gXCJcIjtcbiAgICAvLyBvcGVuYWkgdjQgc3RyZWFtcyBleHBvc2UgYW4gYXN5bmMgaXRlcmF0b3IgdmlhIC5bU3ltYm9sLmFzeW5jSXRlcmF0b3JdXG4gICAgLy8gQ2FzdCB0byBhbnkgdG8gaXRlcmF0ZSBjaHVua3NcbiAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mIHN0cmVhbSBhcyBhbnkpIHtcbiAgICAgIGNvbnN0IGRlbHRhID0gY2h1bms/LmNob2ljZXM/LlswXT8uZGVsdGE/LmNvbnRlbnQ7XG4gICAgICBpZiAoZGVsdGEpIHRleHQgKz0gZGVsdGE7XG4gICAgfVxuICAgIHJldHVybiB7IHRleHQsIHJhdzogc3RyZWFtIH07XG4gIH1cblxuICBsZXQgbGFzdEVycjogYW55O1xuICBmb3IgKGxldCBhdHRlbXB0ID0gMDsgYXR0ZW1wdCA8IDM7IGF0dGVtcHQrKykge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCByZXNwID0gYXdhaXQgY2xpZW50LmNoYXQuY29tcGxldGlvbnMuY3JlYXRlKHtcbiAgICAgICAgbW9kZWw6IG9wdHMubW9kZWwsXG4gICAgICAgIG1lc3NhZ2VzLFxuICAgICAgICBtYXhfdG9rZW5zOiBvcHRzLm1heFRva2VucyA/PyA1MTIsXG4gICAgICAgIHRlbXBlcmF0dXJlOiBvcHRzLnRlbXBlcmF0dXJlID8/IDAuMixcbiAgICAgICAgc3RvcDogb3B0cy5zdG9wLFxuICAgICAgICBleHRyYV9oZWFkZXJzOiBoZWFkZXJzIGFzIGFueSxcbiAgICAgIH0gYXMgYW55KTtcblxuICAgICAgY29uc3QgdGV4dCA9IHJlc3AuY2hvaWNlcz8uWzBdPy5tZXNzYWdlPy5jb250ZW50ID8/IFwiXCI7XG4gICAgICBjb25zdCB1c2FnZTogQ2hhdFVzYWdlIHwgdW5kZWZpbmVkID0gcmVzcC51c2FnZVxuICAgICAgICA/IHtcbiAgICAgICAgICAgIGlucHV0VG9rZW5zOiAocmVzcC51c2FnZSBhcyBhbnkpLnByb21wdF90b2tlbnMgPz8gMCxcbiAgICAgICAgICAgIG91dHB1dFRva2VuczogKHJlc3AudXNhZ2UgYXMgYW55KS5jb21wbGV0aW9uX3Rva2VucyA/PyAwLFxuICAgICAgICAgIH1cbiAgICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgICAgIHJldHVybiB7IHRleHQsIHVzYWdlLCByYXc6IHJlc3AgfTtcbiAgICB9IGNhdGNoIChlcnI6IGFueSkge1xuICAgICAgbGFzdEVyciA9IGVycjtcbiAgICAgIGNvbnN0IHN0YXR1cyA9IGVycj8uc3RhdHVzID8/IGVycj8ucmVzcG9uc2U/LnN0YXR1cztcbiAgICAgIGlmIChhdHRlbXB0IDwgMiAmJiAoc3RhdHVzID09PSA0MjkgfHwgKHN0YXR1cyA+PSA1MDAgJiYgc3RhdHVzIDw9IDU5OSkpKSB7XG4gICAgICAgIGF3YWl0IHNsZWVwKGNvbXB1dGVCYWNrb2ZmRGVsYXlNcyhhdHRlbXB0KSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuICB0aHJvdyBsYXN0RXJyO1xufVxuIl0sIm5hbWVzIjpbIk9wZW5BSSIsImVuZm9yY2VDYXBzIiwicmF0ZUxpbWl0IiwiY29tcHV0ZUJhY2tvZmZEZWxheU1zIiwic2xlZXAiLCJnZXRDb25maWciLCJjaGF0IiwibWVzc2FnZXMiLCJvcHRzIiwicHJvY2VzcyIsImVudiIsIkUyRV9NT0RFIiwibGFzdFVzZXIiLCJyZXZlcnNlIiwiZmluZCIsIm0iLCJyb2xlIiwidGV4dCIsImNvbnRlbnQiLCJ1c2FnZSIsImlucHV0VG9rZW5zIiwib3V0cHV0VG9rZW5zIiwicmF3IiwicmVxdWVzdGVkTWF4VG9rZW5zIiwibWF4VG9rZW5zIiwibWVzc2FnZUNvdW50IiwibGVuZ3RoIiwibW9kZWwiLCJwcm92aWRlciIsImNmZyIsImlzT3BlblJvdXRlciIsImNsaWVudCIsImFwaUtleSIsIm9wZW5yb3V0ZXJBcGlLZXkiLCJvcGVuYWlBcGlLZXkiLCJiYXNlVVJMIiwidW5kZWZpbmVkIiwiaGVhZGVycyIsIm9wZW5yb3V0ZXJTaXRlIiwic3RyZWFtIiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJtYXhfdG9rZW5zIiwidGVtcGVyYXR1cmUiLCJzdG9wIiwiZXh0cmFfaGVhZGVycyIsImNodW5rIiwiZGVsdGEiLCJjaG9pY2VzIiwibGFzdEVyciIsImF0dGVtcHQiLCJyZXNwIiwibWVzc2FnZSIsInByb21wdF90b2tlbnMiLCJjb21wbGV0aW9uX3Rva2VucyIsImVyciIsInN0YXR1cyIsInJlc3BvbnNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/llm/provider.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/zod","vendor-chunks/formdata-node","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/node-fetch","vendor-chunks/agentkeepalive","vendor-chunks/web-streams-polyfill","vendor-chunks/ms","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fllm%2Fchat%2Froute&page=%2Fapi%2Fllm%2Fchat%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fllm%2Fchat%2Froute.ts&appDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fbaramsalem%2Fagents-repo%2Fagents%2Fsrc%2Fagents_wars%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();