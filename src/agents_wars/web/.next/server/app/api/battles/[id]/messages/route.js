"use strict";(()=>{var e={};e.id=679,e.ids=[679],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5679:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>c,staticGenerationAsyncStorage:()=>l});var s={};r.r(s),r.d(s,{GET:()=>p});var a=r(9303),n=r(8716),i=r(670),o=r(3538);async function p(e,{params:t}){try{let{searchParams:r}=new URL(e.url),s=Math.max(1,Number(r.get("page")||1)),a=Math.max(1,Math.min(100,Number(r.get("limit")||20))),n=t.id,[i,p]=await Promise.all([o._.message.findMany({where:{conversationId:n},orderBy:{createdAt:"asc"},skip:(s-1)*a,take:a,select:{id:!0,role:!0,content:!0,tokensIn:!0,tokensOut:!0,costUsd:!0,createdAt:!0}}),o._.message.count({where:{conversationId:n}})]);return new Response(JSON.stringify({page:s,limit:a,total:p,items:i}),{status:200,headers:{"content-type":"application/json"}})}catch{return new Response(JSON.stringify({error:"internal_error"}),{status:500,headers:{"content-type":"application/json"}})}}let u=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/battles/[id]/messages/route",pathname:"/api/battles/[id]/messages",filename:"route",bundlePath:"app/api/battles/[id]/messages/route"},resolvedPagePath:"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/api/battles/[id]/messages/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:c}=u,m="/api/battles/[id]/messages/route";function g(){return(0,i.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:l})}},9303:(e,t,r)=>{e.exports=r(517)},3538:(e,t,r)=>{r.d(t,{_:()=>a});var s=r(3524);let a=global.prisma??new s.PrismaClient({log:["error","warn"]})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[948],()=>r(5679));module.exports=s})();