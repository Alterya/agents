"use strict";(()=>{var e={};e.id=482,e.ids=[482],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},1284:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>g,staticGenerationAsyncStorage:()=>p});var r={};n.r(r),n.d(r,{GET:()=>d,runtime:()=>u});var a=n(9303),s=n(8716),o=n(670),i=n(7546);let u="nodejs";async function d(e,{params:t}){try{let n=e.headers.get("x-request-id")||(globalThis.crypto?.randomUUID?.()??Math.random().toString(36).slice(2)),r=t.id,a=(0,i.Zn)(r);if(!a)return new Response(JSON.stringify({error:"not_found"}),{status:404,headers:{"content-type":"application/json","x-request-id":n}});let s=new URL(e.url);if("json"===s.searchParams.get("format")||(e.headers.get("accept")||"").includes("application/json"))return new Response(JSON.stringify(a),{status:200,headers:{"content-type":"application/json","x-request-id":n}});let o=new TextEncoder,u=new ReadableStream({start(t){function n(){let e=(0,i.Zn)(r);t.enqueue(o.encode(`data: ${JSON.stringify(e)}

`)),e&&"succeeded"!==e.status&&"failed"!==e.status||(t.enqueue(o.encode(`data: [DONE]

`)),t.close())}n();let a=(0,i.y)(r,()=>n());e.signal.addEventListener("abort",()=>{a();try{t.close()}catch{}})}});return new Response(u,{status:200,headers:{"content-type":"text/event-stream; charset=utf-8","cache-control":"no-cache, no-transform",connection:"keep-alive","x-request-id":n}})}catch{let e=globalThis.crypto?.randomUUID?.()??Math.random().toString(36).slice(2);return new Response(JSON.stringify({error:"internal_error"}),{status:500,headers:{"content-type":"application/json","x-request-id":e}})}}let l=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/battles/[id]/status/route",pathname:"/api/battles/[id]/status",filename:"route",bundlePath:"app/api/battles/[id]/status/route"},resolvedPagePath:"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/api/battles/[id]/status/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:p,serverHooks:g}=l,f="/api/battles/[id]/status/route";function h(){return(0,o.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:p})}},9303:(e,t,n)=>{e.exports=n(517)},7546:(e,t,n)=>{n.d(t,{C3:()=>c,Cq:()=>i,Zn:()=>u,gK:()=>d,y:()=>l});let r=new Map,a=new Map,s=new Map,o=new Map;function i(e,t,n){let a=Date.now(),i={id:e,type:t,status:"pending",createdAt:a,updatedAt:a};return r.set(e,i),n&&(s.set(e,n),o.set(n,(o.get(n)??0)+1)),i}function u(e){return r.get(e)}function d(e,t){let n=r.get(e);if(!n)return;let i={...n,...t,updatedAt:Date.now()};r.set(e,i);let u=a.get(e);if(u)for(let e of u)e(i);if("succeeded"===i.status||"failed"===i.status){let t=s.get(e);if(t){let n=o.get(t)??0;o.set(t,Math.max(0,n-1)),s.delete(e)}setTimeout(()=>{r.delete(e),a.delete(e)},250)}return i}function l(e,t){let n=a.get(e)??new Set;return n.add(t),a.set(e,n),()=>{let n=a.get(e);n&&(n.delete(t),0===n.size&&a.delete(e))}}function c(e,t){return(o.get(e)??0)<t}}};var t=require("../../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[948],()=>n(1284));module.exports=r})();