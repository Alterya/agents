"use strict";(()=>{var e={};e.id=492,e.ids=[492],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7811:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>g,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>p});var n={};a.r(n),a.d(n,{GET:()=>i});var s=a(9303),r=a(8716),d=a(670),o=a(7546),u=a(3538);async function i(e,{params:t}){let a=t.id,n=new TextEncoder;return new Response(new ReadableStream({start(t){async function s(){let e=(0,o.Zn)(a);if(!e){let t=await u._.runReport.findUnique({where:{runId:a}});t&&(e={id:a,type:"scale",status:"succeeded",data:{runId:t.runId,total:t.runCount,succeeded:t.stats?.succeeded??void 0,failed:t.stats?.failed??void 0,conversationIds:t.stats?.conversationIds??void 0},createdAt:Date.now(),updatedAt:Date.now()})}t.enqueue(n.encode(`data: ${JSON.stringify(e)}

`)),e&&"succeeded"!==e.status&&"failed"!==e.status||(t.enqueue(n.encode(`data: [DONE]

`)),t.close())}s();let r=(0,o.y)(a,()=>s());e.signal.addEventListener("abort",()=>{r();try{t.close()}catch{}})}}),{status:200,headers:{"content-type":"text/event-stream; charset=utf-8","cache-control":"no-cache, no-transform",connection:"keep-alive"}})}let c=new s.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/scale/[id]/status/route",pathname:"/api/scale/[id]/status",filename:"route",bundlePath:"app/api/scale/[id]/status/route"},resolvedPagePath:"/Users/baramsalem/agents-repo/agents/src/agents_wars/web/app/api/scale/[id]/status/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:l,staticGenerationAsyncStorage:p,serverHooks:f}=c,g="/api/scale/[id]/status/route";function m(){return(0,d.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:p})}},9303:(e,t,a)=>{e.exports=a(517)},7546:(e,t,a)=>{a.d(t,{C3:()=>l,Cq:()=>o,Zn:()=>u,gK:()=>i,y:()=>c});let n=new Map,s=new Map,r=new Map,d=new Map;function o(e,t,a){let s=Date.now(),o={id:e,type:t,status:"pending",createdAt:s,updatedAt:s};return n.set(e,o),a&&(r.set(e,a),d.set(a,(d.get(a)??0)+1)),o}function u(e){return n.get(e)}function i(e,t){let a=n.get(e);if(!a)return;let o={...a,...t,updatedAt:Date.now()};n.set(e,o);let u=s.get(e);if(u)for(let e of u)e(o);if("succeeded"===o.status||"failed"===o.status){let t=r.get(e);if(t){let a=d.get(t)??0;d.set(t,Math.max(0,a-1)),r.delete(e)}setTimeout(()=>{n.delete(e),s.delete(e)},250)}return o}function c(e,t){let a=s.get(e)??new Set;return a.add(t),s.set(e,a),()=>{let a=s.get(e);a&&(a.delete(t),0===a.size&&s.delete(e))}}function l(e,t){return(d.get(e)??0)<t}},3538:(e,t,a)=>{a.d(t,{_:()=>s});var n=a(3524);let s=global.prisma??new n.PrismaClient({log:["error","warn"]})}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[948],()=>a(7811));module.exports=n})();